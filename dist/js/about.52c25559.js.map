{"version":3,"file":"js/about.52c25559.js","mappings":"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","sources":["webpack://sla-mind/./src/interface/Mind/index.ts","webpack://sla-mind/./src/utils/init-Jsmind.ts","webpack://sla-mind/./src/views/Mind/utils/index.ts","webpack://sla-mind/./node_modules/jsmind/js/jsmind.js","webpack://sla-mind/./src/views/Mind/Home.vue?da61","webpack://sla-mind/./src/views/Mind/Home.vue"],"sourcesContent":["export * from './common';\n\nexport enum THEME {\n  PRIMARY = 'primary',\n  WARNING = 'warning',\n  DANGER = 'danger',\n  SUCCESS = 'success',\n  INFO = 'info',\n  GREENSEA = 'greensea',\n  NEPHRITE = 'nephrite',\n  BELIZEHOLE = 'belizehole',\n  WISTERIA = 'wisteria',\n  ASPHALT = 'asphalt',\n  ORANGE = 'orange',\n  PUMPKIN = 'pumpkin',\n  POMEGRANATE = 'pomegranate',\n  CLOUDS = 'clouds',\n  ASBESTOS = 'asbestos',\n}\nexport const ThemeOption = [\n  { label: 'PRIMARY', value: THEME.PRIMARY },\n  { label: 'WARNING', value: THEME.WARNING },\n  { label: 'DANGER', value: THEME.DANGER },\n  { label: 'SUCCESS', value: THEME.SUCCESS },\n  { label: 'INFO', value: THEME.INFO },\n  { label: 'GREENSEA', value: THEME.GREENSEA },\n  { label: 'NEPHRITE', value: THEME.NEPHRITE },\n  { label: 'BELIZEHOLE', value: THEME.BELIZEHOLE },\n  { label: 'WISTERIA', value: THEME.WISTERIA },\n  { label: 'ASPHALT', value: THEME.ASPHALT },\n  { label: 'ORANGE', value: THEME.ORANGE },\n  { label: 'PUMPKIN', value: THEME.PUMPKIN },\n  { label: 'POMEGRANATE', value: THEME.POMEGRANATE },\n  { label: 'CLOUDS', value: THEME.CLOUDS },\n  { label: 'ASBESTOS', value: THEME.ASBESTOS },\n];\nexport enum MODE {\n  FULL = 'full', // 子节点动态分布在根节点两侧 [默认值]\n  SIDE = 'side', // 子节点只分布在根节点右侧\n}\nexport enum LOGLEVEL {\n  DEBUG = 'debug',\n  INFO = 'info',\n  WARN = 'warn',\n  ERROR = 'error',\n  DISABLE = 'disable',\n}\n\nexport interface Meta {\n  name: string;\n  author: string;\n  version: string;\n}\n\nexport interface Options {\n  container: string; // [必选] 容器的ID\n  editable: boolean | false; // 是否启用编辑\n  theme: THEME; // 主题\n  mode: MODE; // 布局模式\n  support_html: boolean | true; // 是否支持节点里的HTML元素\n  log_level: LOGLEVEL; // 日志级别\n  view: object;\n  layout: object;\n  shortcut: object;\n}\n","import jsMind from 'jsmind/js/jsmind.js';\nimport 'jsmind/style/jsmind.css';\n\nObject.defineProperty(window, 'jsMind', {\n  value: jsMind,\n  configurable: false,\n  writable: false,\n});\n","import { reactive, ref, getCurrentInstance } from 'vue';\nimport { ElMessage } from 'element-plus';\nimport { LOGLEVEL, Meta, MODE, Options, THEME } from '@/interface/Mind';\nimport '@/utils/init-Jsmind';\n\nexport const meta = reactive<Meta>({\n  name: 'jsMind remote',\n  author: 'hizzgdev@163.com',\n  version: '0.2',\n});\nexport const format = ref('node_tree');\nexport const data = reactive({\n  id: 'root',\n  topic: 'jsMind',\n  children: [\n    {\n      id: 'easy',\n      topic: 'Easy',\n      direction: 'left',\n      children: [\n        { id: 'easy1', topic: 'Easy to show' },\n        { id: 'easy2', topic: 'Easy to edit' },\n        { id: 'easy3', topic: 'Easy to store' },\n        { id: 'easy4', topic: 'Easy to embed' },\n        {\n          id: 'other3',\n          'background-image': 'ant.png',\n          width: '100',\n          height: '100',\n        },\n      ],\n    },\n    {\n      id: 'open',\n      topic: 'Open Source',\n      direction: 'right',\n      children: [\n        {\n          id: 'open1',\n          topic: 'on GitHub',\n          'background-color': '#eee',\n          'foreground-color': 'blue',\n          'leading-line-color': '#3333ff',\n        },\n        {\n          id: 'open2',\n          topic: 'BSD License',\n          'leading-line-color': '#ff33ff',\n        },\n      ],\n    },\n    {\n      id: 'powerful',\n      topic: 'Powerful',\n      direction: 'right',\n      children: [\n        { id: 'powerful1', topic: 'Base on Javascript' },\n        { id: 'powerful2', topic: 'Base on HTML5' },\n        { id: 'powerful3', topic: 'Depends on you' },\n      ],\n    },\n    {\n      id: 'other',\n      topic: 'test node',\n      direction: 'left',\n      children: [\n        { id: 'other1', topic: \"I'm from local variable\" },\n        { id: 'other2', topic: 'I can do everything' },\n      ],\n    },\n  ],\n});\nexport const options = reactive<Options>({\n  container: 'container',\n  editable: true,\n  theme: THEME.BELIZEHOLE,\n  mode: MODE.FULL,\n  support_html: true,\n  log_level: LOGLEVEL.INFO, // 日志级别\n  view: {\n    engine: 'canvas', // 思维导图各节点之间线条的绘制引擎\n    hmargin: 100, // 思维导图距容器外框的最小水平距离\n    vmargin: 50, // 思维导图距容器外框的最小垂直距离\n    line_width: 2, // 思维导图线条的粗细\n    line_color: '#555', // 思维导图线条的颜色\n    draggable: false, // 当容器不能完全容纳思维导图时，是否允许拖动画布代替鼠标滚动\n    hide_scrollbars_when_draggable: false, // 当设置 draggable = true 时，是否隐藏滚动条\n    node_overflow: 'hidden', // 节点文本过长时的样式\n  },\n  layout: {\n    hspace: 30, // 节点之间的水平间距\n    vspace: 20, // 节点之间的垂直间距\n    pspace: 13, // 节点与连接线之间的水平间距（用于容纳节点收缩/展开控制器）\n  },\n  shortcut: {\n    enable: true, // 是否启用快捷键\n    handles: {}, // 命名的快捷键事件处理器\n    mapping: {\n      // 快捷键映射\n      addchild: [45, 4096 + 13], // <Insert>, <Ctrl> + <Enter>\n      addbrother: 13, // <Enter>\n      editnode: 113, // <F2>\n      delnode: 46, // <Delete>\n      toggle: 32, // <Space>\n      left: 37, // <Left>\n      up: 38, // <Up>\n      right: 39, // <Right>\n      down: 40, // <Down>\n    },\n  },\n});\nexport let _jm: any = null;\n\nexport const open_view = () => {\n  const mind = { meta, data, format: format.value };\n  _jm = new window.jsMind(options);\n  _jm.show(mind);\n};\n\nexport const set_theme = (theme_name: THEME) => {\n  _jm.set_theme(theme_name);\n};\n\nexport const handle_editable = (bool: boolean) => {\n  if (bool) {\n    _jm.disable_edit();\n    ElMessage.warning('当前思维导图状态：不可操作');\n  } else {\n    _jm.enable_edit();\n    ElMessage.success('当前思维导图状态：可操作');\n  }\n};\n\n// function open_json() {\n//   const mind = {\n//     meta: {\n//       name: 'jsMind remote',\n//       author: 'hizzgdev@163.com',\n//       version: '0.2',\n//     },\n//     format: 'node_tree',\n//     data: {\n//       id: 'root',\n//       topic: 'jsMind',\n//       children: [\n//         {\n//           id: 'easy',\n//           topic: 'Easy',\n//           direction: 'left',\n//           children: [\n//             { id: 'easy1', topic: 'Easy to show' },\n//             { id: 'easy2', topic: 'Easy to edit' },\n//             { id: 'easy3', topic: 'Easy to store' },\n//             { id: 'easy4', topic: 'Easy to embed' },\n//             {\n//               id: 'other3',\n//               'background-image': 'ant.png',\n//               width: '100',\n//               height: '100',\n//             },\n//           ],\n//         },\n//         {\n//           id: 'open',\n//           topic: 'Open Source',\n//           direction: 'right',\n//           children: [\n//             {\n//               id: 'open1',\n//               topic: 'on GitHub',\n//               'background-color': '#eee',\n//               'foreground-color': 'blue',\n//               'leading-line-color': '#3333ff',\n//             },\n//             {\n//               id: 'open2',\n//               topic: 'BSD License',\n//               'leading-line-color': '#ff33ff',\n//             },\n//           ],\n//         },\n//         {\n//           id: 'powerful',\n//           topic: 'Powerful',\n//           direction: 'right',\n//           children: [\n//             { id: 'powerful1', topic: 'Base on Javascript' },\n//             { id: 'powerful2', topic: 'Base on HTML5' },\n//             { id: 'powerful3', topic: 'Depends on you' },\n//           ],\n//         },\n//         {\n//           id: 'other',\n//           topic: 'test node',\n//           direction: 'left',\n//           children: [\n//             { id: 'other1', topic: \"I'm from local variable\" },\n//             { id: 'other2', topic: 'I can do everything' },\n//           ],\n//         },\n//       ],\n//     },\n//   };\n//   _jm.show(mind);\n// }\n//\n// function open_ajax() {\n//   const mind_url = 'data_example.json';\n//   window.jsMind.util.ajax.get(mind_url, function (mind) {\n//     _jm.show(mind);\n//   });\n// }\n//\n// function screen_shot() {\n//   _jm.screenshot.shootDownload();\n// }\n//\n// function show_data() {\n//   const mind_data = _jm.get_data();\n//   const mind_string = window.jsMind.util.json.json2string(mind_data);\n//   prompt_info(mind_string);\n// }\n//\n// function save_file() {\n//   const mind_data = _jm.get_data();\n//   const mind_name = mind_data.meta.name;\n//   const mind_str = window.jsMind.util.json.json2string(mind_data);\n//   window.jsMind.util.file.save(mind_str, 'text/jsmind', mind_name + '.jm');\n// }\n//\n// function open_file() {\n//   const file_input = document.getElementById('file_input');\n//   const files = file_input.files;\n//   if (files.length > 0) {\n//     const file_data = files[0];\n//     window.jsMind.util.file.read(file_data, function (jsmind_data, jsmind_name) {\n//       const mind = window.jsMind.util.json.string2json(jsmind_data);\n//       if (mind) {\n//         _jm.show(mind);\n//       } else {\n//         prompt_info('can not open this file as mindmap');\n//       }\n//     });\n//   } else {\n//     prompt_info('please choose a file first');\n//   }\n// }\n//\n// function select_node() {\n//   const nodeid = 'other';\n//   _jm.select_node(nodeid);\n// }\n//\n// function show_selected() {\n//   const selected_node = _jm.get_selected_node();\n//   if (selected_node) {\n//     prompt_info(selected_node.topic);\n//   } else {\n//     prompt_info('nothing');\n//   }\n// }\n//\n// function get_selected_nodeid() {\n//   const selected_node = _jm.get_selected_node();\n//   if (selected_node) {\n//     return selected_node.id;\n//   } else {\n//     return null;\n//   }\n// }\n//\n// function add_node() {\n//   const selected_node = _jm.get_selected_node(); // as parent of new node\n//   if (!selected_node) {\n//     prompt_info('please select a node first.');\n//     return;\n//   }\n//\n//   const nodeid = window.jsMind.util.uuid.newid();\n//   const topic = '* Node_' + nodeid.substr(nodeid.length - 6) + ' *';\n//   const node = _jm.add_node(selected_node, nodeid, topic);\n// }\n//\n// const imageChooser = document.getElementById('image-chooser');\n//\n// imageChooser.addEventListener(\n//   'change',\n//   function (event) {\n//     // Read file here.\n//     const reader = new FileReader();\n//     reader.onloadend = function () {\n//       const selected_node = _jm.get_selected_node();\n//       const nodeid = window.jsMind.util.uuid.newid();\n//       const topic = undefined;\n//       const data = {\n//         'background-image': reader.result,\n//         width: '100',\n//         height: '100',\n//       };\n//       const node = _jm.add_node(selected_node, nodeid, topic, data);\n//       //var node = _jm.add_image_node(selected_node, nodeid, reader.result, 100, 100);\n//       //add_image_node:function(parent_node, nodeid, image, width, height, data, idx, direction, expanded){\n//     };\n//\n//     const file = imageChooser.files[0];\n//     if (file) {\n//       reader.readAsDataURL(file);\n//     }\n//   },\n//   false\n// );\n//\n// function add_image_node() {\n//   const selected_node = _jm.get_selected_node(); // as parent of new node\n//   if (!selected_node) {\n//     prompt_info('please select a node first.');\n//     return;\n//   }\n//\n//   imageChooser.focus();\n//   imageChooser.click();\n// }\n//\n// function modify_node() {\n//   const selected_id = get_selected_nodeid();\n//   if (!selected_id) {\n//     prompt_info('please select a node first.');\n//     return;\n//   }\n//\n//   // modify the topic\n//   _jm.update_node(selected_id, '--- modified ---');\n// }\n//\n// function move_to_first() {\n//   const selected_id = get_selected_nodeid();\n//   if (!selected_id) {\n//     prompt_info('please select a node first.');\n//     return;\n//   }\n//\n//   _jm.move_node(selected_id, '_first_');\n// }\n//\n// function move_to_last() {\n//   const selected_id = get_selected_nodeid();\n//   if (!selected_id) {\n//     prompt_info('please select a node first.');\n//     return;\n//   }\n//\n//   _jm.move_node(selected_id, '_last_');\n// }\n//\n// function move_node() {\n//   // move a node before another\n//   _jm.move_node('other', 'open');\n// }\n//\n// function remove_node() {\n//   const selected_id = get_selected_nodeid();\n//   if (!selected_id) {\n//     prompt_info('please select a node first.');\n//     return;\n//   }\n//\n//   _jm.remove_node(selected_id);\n// }\n//\n// function change_text_font() {\n//   const selected_id = get_selected_nodeid();\n//   if (!selected_id) {\n//     prompt_info('please select a node first.');\n//     return;\n//   }\n//\n//   _jm.set_node_font_style(selected_id, 28);\n// }\n//\n// function change_text_color() {\n//   const selected_id = get_selected_nodeid();\n//   if (!selected_id) {\n//     prompt_info('please select a node first.');\n//     return;\n//   }\n//\n//   _jm.set_node_color(selected_id, null, '#000');\n// }\n//\n// function change_background_color() {\n//   const selected_id = get_selected_nodeid();\n//   if (!selected_id) {\n//     prompt_info('please select a node first.');\n//     return;\n//   }\n//\n//   _jm.set_node_color(selected_id, '#eee', null);\n// }\n//\n// function change_background_image() {\n//   const selected_id = get_selected_nodeid();\n//   if (!selected_id) {\n//     prompt_info('please select a node first.');\n//     return;\n//   }\n//\n//   _jm.set_node_background_image(selected_id, 'ant.png', 100, 100);\n// }\n//\n\n//\n// const zoomInButton = document.getElementById('zoom-in-button');\n// const zoomOutButton = document.getElementById('zoom-out-button');\n//\n// function zoomIn() {\n//   if (_jm.view.zoomIn()) {\n//     zoomOutButton.disabled = false;\n//   } else {\n//     zoomInButton.disabled = true;\n//   }\n// }\n//\n// function zoomOut() {\n//   if (_jm.view.zoomOut()) {\n//     zoomInButton.disabled = false;\n//   } else {\n//     zoomOutButton.disabled = true;\n//   }\n// }\n//\n\n//\n// // this method change size of container, perpare for adjusting jsmind\n// function change_container() {\n//   const c = document.getElementById('jsmind_container');\n//   c.style.width = '800px';\n//   c.style.height = '500px';\n// }\n//\n// function resize_jsmind() {\n//   _jm.resize();\n// }\n//\n// function expand() {\n//   const selected_id = get_selected_nodeid();\n//   if (!selected_id) {\n//     prompt_info('please select a node first.');\n//     return;\n//   }\n//\n//   _jm.expand_node(selected_id);\n// }\n//\n// function collapse() {\n//   const selected_id = get_selected_nodeid();\n//   if (!selected_id) {\n//     prompt_info('please select a node first.');\n//     return;\n//   }\n//\n//   _jm.collapse_node(selected_id);\n// }\n//\n// function toggle() {\n//   const selected_id = get_selected_nodeid();\n//   if (!selected_id) {\n//     prompt_info('please select a node first.');\n//     return;\n//   }\n//\n//   _jm.toggle_node(selected_id);\n// }\n//\n// function expand_all() {\n//   _jm.expand_all();\n// }\n//\n// function expand_to_level2() {\n//   _jm.expand_to_depth(2);\n// }\n//\n// function expand_to_level3() {\n//   _jm.expand_to_depth(3);\n// }\n//\n// function collapse_all() {\n//   _jm.collapse_all();\n// }\n//\n// function get_nodearray_data() {\n//   const mind_data = _jm.get_data('node_array');\n//   const mind_string = window.jsMind.util.json.json2string(mind_data);\n//   prompt_info(mind_string);\n// }\n//\n// function save_nodearray_file() {\n//   const mind_data = _jm.get_data('node_array');\n//   const mind_name = mind_data.meta.name;\n//   const mind_str = window.jsMind.util.json.json2string(mind_data);\n//   window.jsMind.util.file.save(mind_str, 'text/jsmind', mind_name + '.jm');\n// }\n//\n// function open_nodearray() {\n//   const file_input = document.getElementById('file_input_nodearray');\n//   const files = file_input.files;\n//   if (files.length > 0) {\n//     const file_data = files[0];\n//     window.jsMind.util.file.read(file_data, function (jsmind_data, jsmind_name) {\n//       const mind = window.jsMind.util.json.string2json(jsmind_data);\n//       if (mind) {\n//         _jm.show(mind);\n//       } else {\n//         prompt_info('can not open this file as mindmap');\n//       }\n//     });\n//   } else {\n//     prompt_info('please choose a file first');\n//   }\n// }\n//\n// function get_freemind_data() {\n//   const mind_data = _jm.get_data('freemind');\n//   const mind_string = window.jsMind.util.json.json2string(mind_data);\n//   alert(mind_string);\n// }\n//\n// function save_freemind_file() {\n//   const mind_data = _jm.get_data('freemind');\n//   const mind_name = mind_data.meta.name || 'freemind';\n//   const mind_str = mind_data.data;\n//   window.jsMind.util.file.save(mind_str, 'text/xml', mind_name + '.mm');\n// }\n//\n// function open_freemind() {\n//   const file_input = document.getElementById('file_input_freemind');\n//   const files = file_input.files;\n//   if (files.length > 0) {\n//     const file_data = files[0];\n//     window.jsMind.util.file.read(file_data, function (freemind_data, freemind_name) {\n//       if (freemind_data) {\n//         let mind_name = freemind_name;\n//         if (/.*\\.mm$/.test(mind_name)) {\n//           mind_name = freemind_name.substring(0, freemind_name.length - 3);\n//         }\n//         const mind = {\n//           meta: {\n//             name: mind_name,\n//             author: 'hizzgdev@163.com',\n//             version: '1.0.1',\n//           },\n//           format: 'freemind',\n//           data: freemind_data,\n//         };\n//         _jm.show(mind);\n//       } else {\n//         prompt_info('can not open this file as mindmap');\n//       }\n//     });\n//   } else {\n//     prompt_info('please choose a file first');\n//   }\n// }\n//\n// function get_text_data() {\n//   const mind_data = _jm.get_data('text');\n//   const mind_string = window.jsMind.util.json.json2string(mind_data);\n//   prompt_info(mind_string);\n// }\n//\n// function save_text_file() {\n//   const mind_data = _jm.get_data('text');\n//   const mind_name = mind_data.meta.name;\n//   const mind_str = window.jsMind.util.json.json2string(mind_data);\n//   window.jsMind.util.file.save(mind_str, 'text/jsmind', mind_name + '.jm');\n// }\n//\n// function open_text() {\n//   const file_input = document.getElementById('file_input_text');\n//   const files = file_input.files;\n//   if (files.length > 0) {\n//     const file_data = files[0];\n//     window.jsMind.util.file.read(file_data, function (jsmind_data, jsmind_name) {\n//       const mind = window.jsMind.util.json.string2json(jsmind_data);\n//       if (mind) {\n//         _jm.show(mind);\n//       } else {\n//         prompt_info('can not open this file as mindmap');\n//       }\n//     });\n//   } else {\n//     prompt_info('please choose a file first');\n//   }\n// }\n//\n// function prompt_info(msg) {\n//   alert(msg);\n// }\n//\n// open_empty();\n","/**\n * @license BSD\n * @copyright 2014-2023 hizzgdev@163.com\n *\n * Project Home:\n *   https://github.com/hizzgdev/jsmind/\n */\n\n; (function ($w) {\n    'use strict';\n    // set 'jsMind' as the library name.\n    // __name__ should be a const value, Never try to change it easily.\n    var __name__ = 'jsMind';\n    // library version\n    var __version__ = '0.5.2';\n    // author\n    var __author__ = 'hizzgdev@163.com';\n\n    // an noop function define\n    var _noop = function () { };\n    var logger = (typeof console === 'undefined') ? {\n        log: _noop, debug: _noop, error: _noop, warn: _noop, info: _noop\n    } : console;\n\n    // check global variables\n    if (typeof module === 'undefined' || !module.exports) {\n        if (typeof $w[__name__] != 'undefined') {\n            logger.log(__name__ + ' has been already exist.');\n            return;\n        }\n    }\n\n    // shortcut of methods in dom\n    var $d = $w.document;\n    var $g = function (id) { return $d.getElementById(id); };\n    var $c = function (tag) { return $d.createElement(tag); };\n    var $t = function (n, t) { if (n.hasChildNodes()) { n.firstChild.nodeValue = t; } else { n.appendChild($d.createTextNode(t)); } };\n\n    var $h = function (n, t) {\n        if (t instanceof HTMLElement) {\n            n.innerHTML = '';\n            n.appendChild(t);\n        } else {\n            n.innerHTML = t;\n        }\n    };\n    // detect isElement\n    var $i = function (el) { return !!el && (typeof el === 'object') && (el.nodeType === 1) && (typeof el.style === 'object') && (typeof el.ownerDocument === 'object'); };\n    if (typeof String.prototype.startsWith != 'function') { String.prototype.startsWith = function (p) { return this.slice(0, p.length) === p; }; }\n\n    var DEFAULT_OPTIONS = {\n        container: '',   // id of the container\n        editable: false, // you can change it in your options\n        theme: null,\n        mode: 'full',    // full or side\n        support_html: true,\n\n        view: {\n            engine: 'canvas',\n            hmargin: 100,\n            vmargin: 50,\n            line_width: 2,\n            line_color: '#555',\n            draggable: false, // drag the mind map with your mouse, when it's larger that the container\n            hide_scrollbars_when_draggable: false, // hide container scrollbars, when mind map is larger than container and draggable option is true.\n            node_overflow: 'hidden' // hidden or wrap\n        },\n        layout: {\n            hspace: 30,\n            vspace: 20,\n            pspace: 13\n        },\n        default_event_handle: {\n            enable_mousedown_handle: true,\n            enable_click_handle: true,\n            enable_dblclick_handle: true,\n            enable_mousewheel_handle: true\n        },\n        shortcut: {\n            enable: true,\n            handles: {\n            },\n            mapping: {\n                addchild: [45, 4096+13], // Insert, Ctrl+Enter\n                addbrother: 13, // Enter\n                editnode: 113,// F2\n                delnode: 46, // Delete\n                toggle: 32, // Space\n                left: 37, // Left\n                up: 38, // Up\n                right: 39, // Right\n                down: 40, // Down\n            }\n        },\n    };\n\n    // core object\n    var jm = function (options) {\n        jm.current = this;\n\n        this.version = __version__;\n        var opts = {};\n        jm.util.json.merge(opts, DEFAULT_OPTIONS);\n        jm.util.json.merge(opts, options);\n\n        if (!opts.container) {\n            logger.error('the options.container should not be null or empty.');\n            return;\n        }\n        this.options = opts;\n        this.initialized = false;\n        this.mind = null;\n        this.event_handles = [];\n        this.init();\n    };\n\n    // ============= static object =============================================\n    jm.direction = {\n        left: -1, center: 0, right: 1, of: function (dir) {\n            if (!dir || dir === -1 || dir === 0 || dir === 1) {\n                return dir;\n            }\n            if (dir === '-1' || dir === '0' || dir === '1') {\n                return parseInt(dir);\n            }\n            if (dir.toLowerCase() === 'left') {\n                return this.left;\n            }\n            if (dir.toLowerCase() === 'right') {\n                return this.right;\n            }\n            if (dir.toLowerCase() === 'center') {\n                return this.center;\n            }\n        }\n    };\n    jm.event_type = { show: 1, resize: 2, edit: 3, select: 4 };\n    jm.key = { meta: 1 << 13, ctrl: 1 << 12, alt: 1 << 11, shift: 1 << 10 };\n\n    jm.node = function (sId, iIndex, sTopic, oData, bIsRoot, oParent, eDirection, bExpanded) {\n        if (!sId) { logger.error('invalid node id'); return; }\n        if (typeof iIndex != 'number') { logger.error('invalid node index'); return; }\n        if (typeof bExpanded === 'undefined') { bExpanded = true; }\n        this.id = sId;\n        this.index = iIndex;\n        this.topic = sTopic;\n        this.data = oData || {};\n        this.isroot = bIsRoot;\n        this.parent = oParent;\n        this.direction = eDirection;\n        this.expanded = !!bExpanded;\n        this.children = [];\n        this._data = {};\n    };\n\n    jm.node.compare = function (node1, node2) {\n        // '-1' is alwary the last\n        var r = 0;\n        var i1 = node1.index;\n        var i2 = node2.index;\n        if (i1 >= 0 && i2 >= 0) {\n            r = i1 - i2;\n        } else if (i1 == -1 && i2 == -1) {\n            r = 0;\n        } else if (i1 == -1) {\n            r = 1;\n        } else if (i2 == -1) {\n            r = -1;\n        } else {\n            r = 0;\n        }\n        //logger.debug(i1+' <> '+i2+'  =  '+r);\n        return r;\n    };\n\n    jm.node.inherited = function (pnode, node) {\n        if (!!pnode && !!node) {\n            if (pnode.id === node.id) {\n                return true;\n            }\n            if (pnode.isroot) {\n                return true;\n            }\n            var pid = pnode.id;\n            var p = node;\n            while (!p.isroot) {\n                p = p.parent;\n                if (p.id === pid) {\n                    return true;\n                }\n            }\n        }\n        return false;\n    };\n\n    jm.node.is_node = function (n) {\n        return !!n && n instanceof jm.node;\n    };\n\n    jm.node.prototype = {\n        get_location: function () {\n            var vd = this._data.view;\n            return {\n                x: vd.abs_x,\n                y: vd.abs_y\n            };\n        },\n        get_size: function () {\n            var vd = this._data.view;\n            return {\n                w: vd.width,\n                h: vd.height\n            }\n        }\n    };\n\n\n    jm.mind = function () {\n        this.name = null;\n        this.author = null;\n        this.version = null;\n        this.root = null;\n        this.selected = null;\n        this.nodes = {};\n    };\n\n    jm.mind.prototype = {\n        get_node: function (nodeid) {\n            if (nodeid in this.nodes) {\n                return this.nodes[nodeid];\n            } else {\n                logger.warn('the node[id=' + nodeid + '] can not be found');\n                return null;\n            }\n        },\n\n        set_root: function (nodeid, topic, data) {\n            if (this.root == null) {\n                this.root = new jm.node(nodeid, 0, topic, data, true);\n                this._put_node(this.root);\n                return this.root;\n            } else {\n                logger.error('root node is already exist');\n                return null;\n            }\n        },\n\n        add_node: function (parent_node, nodeid, topic, data, direction, expanded, idx) {\n            if (!jm.util.is_node(parent_node)) {\n                logger.error('the parent_node ' + parent_node + ' is not a node.');\n                return null;\n            }\n            var node_index = idx || -1;\n            var node = new jm.node(nodeid, node_index, topic, data, false, parent_node, parent_node.direction, expanded);\n            if (parent_node.isroot) {\n                node.direction = direction || jm.direction.right;\n            }\n            if (this._put_node(node)) {\n                parent_node.children.push(node);\n                this._reindex(parent_node);\n            } else {\n                logger.error('fail, the nodeid \\'' + node.id + '\\' has been already exist.');\n                node = null;\n            }\n            return node;\n        },\n\n        insert_node_before: function (node_before, nodeid, topic, data, direction) {\n            if (!jm.util.is_node(node_before)) {\n                logger.error('the node_before ' + node_before + ' is not a node.');\n                return null;\n            }\n            var node_index = node_before.index - 0.5;\n            return this.add_node(node_before.parent, nodeid, topic, data, direction, true, node_index);\n        },\n\n        get_node_before: function (node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return null;\n                } else {\n                    return this.get_node_before(the_node);\n                }\n            }\n            if (node.isroot) { return null; }\n            var idx = node.index - 2;\n            if (idx >= 0) {\n                return node.parent.children[idx];\n            } else {\n                return null;\n            }\n        },\n\n        insert_node_after: function (node_after, nodeid, topic, data, direction) {\n            if (!jm.util.is_node(node_after)) {\n                logger.error('the node_after ' + node_after + ' is not a node.');\n                return null;\n            }\n            var node_index = node_after.index + 0.5;\n            return this.add_node(node_after.parent, nodeid, topic, data, direction, true, node_index);\n        },\n\n        get_node_after: function (node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return null;\n                } else {\n                    return this.get_node_after(the_node);\n                }\n            }\n            if (node.isroot) { return null; }\n            var idx = node.index;\n            var brothers = node.parent.children;\n            if (brothers.length > idx) {\n                return node.parent.children[idx];\n            } else {\n                return null;\n            }\n        },\n\n        move_node: function (node, before_id, parent_id, direction) {\n            if (!jm.util.is_node(node)) {\n                logger.error('the parameter node ' + node + ' is not a node.');\n                return null;\n            }\n            if (!parent_id) {\n                parent_id = node.parent.id;\n            }\n            return this._move_node(node, before_id, parent_id, direction);\n        },\n\n        _flow_node_direction: function (node, direction) {\n            if (typeof direction === 'undefined') {\n                direction = node.direction;\n            } else {\n                node.direction = direction;\n            }\n            var len = node.children.length;\n            while (len--) {\n                this._flow_node_direction(node.children[len], direction);\n            }\n        },\n\n        _move_node_internal: function (node, beforeid) {\n            if (!!node && !!beforeid) {\n                if (beforeid == '_last_') {\n                    node.index = -1;\n                    this._reindex(node.parent);\n                } else if (beforeid == '_first_') {\n                    node.index = 0;\n                    this._reindex(node.parent);\n                } else {\n                    var node_before = (!!beforeid) ? this.get_node(beforeid) : null;\n                    if (node_before != null && node_before.parent != null && node_before.parent.id == node.parent.id) {\n                        node.index = node_before.index - 0.5;\n                        this._reindex(node.parent);\n                    }\n                }\n            }\n            return node;\n        },\n\n        _move_node: function (node, beforeid, parentid, direction) {\n            if (!!node && !!parentid) {\n                var parent_node = this.get_node(parentid)\n                if (jm.node.inherited(node, parent_node)) {\n                    logger.error('can not move a node to its children');\n                    return null;\n                }\n                if (node.parent.id != parentid) {\n                    // remove from parent's children\n                    var sibling = node.parent.children;\n                    var si = sibling.length;\n                    while (si--) {\n                        if (sibling[si].id == node.id) {\n                            sibling.splice(si, 1);\n                            break;\n                        }\n                    }\n                    node.parent = parent_node;\n                    parent_node.children.push(node);\n                }\n\n                if (node.parent.isroot) {\n                    if (direction == jm.direction.left) {\n                        node.direction = direction;\n                    } else {\n                        node.direction = jm.direction.right;\n                    }\n                } else {\n                    node.direction = node.parent.direction;\n                }\n                this._move_node_internal(node, beforeid);\n                this._flow_node_direction(node);\n            }\n            return node;\n        },\n\n        remove_node: function (node) {\n            if (!jm.util.is_node(node)) {\n                logger.error('the parameter node ' + node + ' is not a node.');\n                return false;\n            }\n            if (node.isroot) {\n                logger.error('fail, can not remove root node');\n                return false;\n            }\n            if (this.selected != null && this.selected.id == node.id) {\n                this.selected = null;\n            }\n            // clean all subordinate nodes\n            var children = node.children;\n            var ci = children.length;\n            while (ci--) {\n                this.remove_node(children[ci]);\n            }\n            // clean all children\n            children.length = 0;\n            // remove from parent's children\n            var sibling = node.parent.children;\n            var si = sibling.length;\n            while (si--) {\n                if (sibling[si].id == node.id) {\n                    sibling.splice(si, 1);\n                    break;\n                }\n            }\n            // remove from global nodes\n            delete this.nodes[node.id];\n            // clean all properties\n            for (var k in node) {\n                delete node[k];\n            }\n            // remove it's self\n            node = null;\n            //delete node;\n            return true;\n        },\n\n        _put_node: function (node) {\n            if (node.id in this.nodes) {\n                logger.warn('the nodeid \\'' + node.id + '\\' has been already exist.');\n                return false;\n            } else {\n                this.nodes[node.id] = node;\n                return true;\n            }\n        },\n\n        _reindex: function (node) {\n            if (node instanceof jm.node) {\n                node.children.sort(jm.node.compare);\n                for (var i = 0; i < node.children.length; i++) {\n                    node.children[i].index = i + 1;\n                }\n            }\n        },\n    };\n\n    jm.format = {\n        node_tree: {\n            example: {\n                \"meta\": {\n                    \"name\": __name__,\n                    \"author\": __author__,\n                    \"version\": __version__\n                },\n                \"format\": \"node_tree\",\n                \"data\": { \"id\": \"root\", \"topic\": \"jsMind Example\" }\n            },\n            get_mind: function (source) {\n                var df = jm.format.node_tree;\n                var mind = new jm.mind();\n                mind.name = source.meta.name;\n                mind.author = source.meta.author;\n                mind.version = source.meta.version;\n                df._parse(mind, source.data);\n                return mind;\n            },\n            get_data: function (mind) {\n                var df = jm.format.node_tree;\n                var json = {};\n                json.meta = {\n                    name: mind.name,\n                    author: mind.author,\n                    version: mind.version\n                };\n                json.format = 'node_tree';\n                json.data = df._buildnode(mind.root);\n                return json;\n            },\n\n            _parse: function (mind, node_root) {\n                var df = jm.format.node_tree;\n                var data = df._extract_data(node_root);\n                mind.set_root(node_root.id, node_root.topic, data);\n                if ('children' in node_root) {\n                    var children = node_root.children;\n                    for (var i = 0; i < children.length; i++) {\n                        df._extract_subnode(mind, mind.root, children[i]);\n                    }\n                }\n            },\n\n            _extract_data: function (node_json) {\n                var data = {};\n                for (var k in node_json) {\n                    if (k == 'id' || k == 'topic' || k == 'children' || k == 'direction' || k == 'expanded') {\n                        continue;\n                    }\n                    data[k] = node_json[k];\n                }\n                return data;\n            },\n\n            _extract_subnode: function (mind, node_parent, node_json) {\n                var df = jm.format.node_tree;\n                var data = df._extract_data(node_json);\n                var d = null;\n                if (node_parent.isroot) {\n                    d = node_json.direction == 'left' ? jm.direction.left : jm.direction.right;\n                }\n                var node = mind.add_node(node_parent, node_json.id, node_json.topic, data, d, node_json.expanded);\n                if (!!node_json['children']) {\n                    var children = node_json.children;\n                    for (var i = 0; i < children.length; i++) {\n                        df._extract_subnode(mind, node, children[i]);\n                    }\n                }\n            },\n\n            _buildnode: function (node) {\n                var df = jm.format.node_tree;\n                if (!(node instanceof jm.node)) { return; }\n                var o = {\n                    id: node.id,\n                    topic: node.topic,\n                    expanded: node.expanded\n                };\n                if (!!node.parent && node.parent.isroot) {\n                    o.direction = node.direction == jm.direction.left ? 'left' : 'right';\n                }\n                if (node.data != null) {\n                    var node_data = node.data;\n                    for (var k in node_data) {\n                        o[k] = node_data[k];\n                    }\n                }\n                var children = node.children;\n                if (children.length > 0) {\n                    o.children = [];\n                    for (var i = 0; i < children.length; i++) {\n                        o.children.push(df._buildnode(children[i]));\n                    }\n                }\n                return o;\n            }\n        },\n\n        node_array: {\n            example: {\n                \"meta\": {\n                    \"name\": __name__,\n                    \"author\": __author__,\n                    \"version\": __version__\n                },\n                \"format\": \"node_array\",\n                \"data\": [\n                    { \"id\": \"root\", \"topic\": \"jsMind Example\", \"isroot\": true }\n                ]\n            },\n\n            get_mind: function (source) {\n                var df = jm.format.node_array;\n                var mind = new jm.mind();\n                mind.name = source.meta.name;\n                mind.author = source.meta.author;\n                mind.version = source.meta.version;\n                df._parse(mind, source.data);\n                return mind;\n            },\n\n            get_data: function (mind) {\n                var df = jm.format.node_array;\n                var json = {};\n                json.meta = {\n                    name: mind.name,\n                    author: mind.author,\n                    version: mind.version\n                };\n                json.format = 'node_array';\n                json.data = [];\n                df._array(mind, json.data);\n                return json;\n            },\n\n            _parse: function (mind, node_array) {\n                var df = jm.format.node_array;\n                var narray = node_array.slice(0);\n                // reverse array for improving looping performance\n                narray.reverse();\n                var root_node = df._extract_root(mind, narray);\n                if (!!root_node) {\n                    df._extract_subnode(mind, root_node, narray);\n                } else {\n                    logger.error('root node can not be found');\n                }\n            },\n\n            _extract_root: function (mind, node_array) {\n                var df = jm.format.node_array;\n                var i = node_array.length;\n                while (i--) {\n                    if ('isroot' in node_array[i] && node_array[i].isroot) {\n                        var root_json = node_array[i];\n                        var data = df._extract_data(root_json);\n                        var node = mind.set_root(root_json.id, root_json.topic, data);\n                        node_array.splice(i, 1);\n                        return node;\n                    }\n                }\n                return null;\n            },\n\n            _extract_subnode: function (mind, parent_node, node_array) {\n                var df = jm.format.node_array;\n                var i = node_array.length;\n                var node_json = null;\n                var data = null;\n                var extract_count = 0;\n                while (i--) {\n                    node_json = node_array[i];\n                    if (node_json.parentid == parent_node.id) {\n                        data = df._extract_data(node_json);\n                        var d = null;\n                        var node_direction = node_json.direction;\n                        if (!!node_direction) {\n                            d = node_direction == 'left' ? jm.direction.left : jm.direction.right;\n                        }\n                        var node = mind.add_node(parent_node, node_json.id, node_json.topic, data, d, node_json.expanded);\n                        node_array.splice(i, 1);\n                        extract_count++;\n                        var sub_extract_count = df._extract_subnode(mind, node, node_array);\n                        if (sub_extract_count > 0) {\n                            // reset loop index after extract subordinate node\n                            i = node_array.length;\n                            extract_count += sub_extract_count;\n                        }\n                    }\n                }\n                return extract_count;\n            },\n\n            _extract_data: function (node_json) {\n                var data = {};\n                for (var k in node_json) {\n                    if (k == 'id' || k == 'topic' || k == 'parentid' || k == 'isroot' || k == 'direction' || k == 'expanded') {\n                        continue;\n                    }\n                    data[k] = node_json[k];\n                }\n                return data;\n            },\n\n            _array: function (mind, node_array) {\n                var df = jm.format.node_array;\n                df._array_node(mind.root, node_array);\n            },\n\n            _array_node: function (node, node_array) {\n                var df = jm.format.node_array;\n                if (!(node instanceof jm.node)) { return; }\n                var o = {\n                    id: node.id,\n                    topic: node.topic,\n                    expanded: node.expanded\n                };\n                if (!!node.parent) {\n                    o.parentid = node.parent.id;\n                }\n                if (node.isroot) {\n                    o.isroot = true;\n                }\n                if (!!node.parent && node.parent.isroot) {\n                    o.direction = node.direction == jm.direction.left ? 'left' : 'right';\n                }\n                if (node.data != null) {\n                    var node_data = node.data;\n                    for (var k in node_data) {\n                        o[k] = node_data[k];\n                    }\n                }\n                node_array.push(o);\n                var ci = node.children.length;\n                for (var i = 0; i < ci; i++) {\n                    df._array_node(node.children[i], node_array);\n                }\n            },\n        },\n\n        freemind: {\n            example: {\n                \"meta\": {\n                    \"name\": __name__,\n                    \"author\": __author__,\n                    \"version\": __version__\n                },\n                \"format\": \"freemind\",\n                \"data\": \"<map version=\\\"1.0.1\\\"><node ID=\\\"root\\\" TEXT=\\\"freemind Example\\\"/></map>\"\n            },\n            get_mind: function (source) {\n                var df = jm.format.freemind;\n                var mind = new jm.mind();\n                mind.name = source.meta.name;\n                mind.author = source.meta.author;\n                mind.version = source.meta.version;\n                var xml = source.data;\n                var xml_doc = df._parse_xml(xml);\n                var xml_root = df._find_root(xml_doc);\n                df._load_node(mind, null, xml_root);\n                return mind;\n            },\n\n            get_data: function (mind) {\n                var df = jm.format.freemind;\n                var json = {};\n                json.meta = {\n                    name: mind.name,\n                    author: mind.author,\n                    version: mind.version\n                };\n                json.format = 'freemind';\n                var xmllines = [];\n                xmllines.push('<map version=\\\"1.0.1\\\">');\n                df._buildmap(mind.root, xmllines);\n                xmllines.push('</map>');\n                json.data = xmllines.join(' ');\n                return json;\n            },\n\n            _parse_xml: function (xml) {\n                var xml_doc = null;\n                if (window.DOMParser) {\n                    var parser = new DOMParser();\n                    xml_doc = parser.parseFromString(xml, 'text/xml');\n                } else { // Internet Explorer\n                    xml_doc = new ActiveXObject('Microsoft.XMLDOM');\n                    xml_doc.async = false;\n                    xml_doc.loadXML(xml);\n                }\n                return xml_doc;\n            },\n\n            _find_root: function (xml_doc) {\n                var nodes = xml_doc.childNodes;\n                var node = null;\n                var root = null;\n                var n = null;\n                for (var i = 0; i < nodes.length; i++) {\n                    n = nodes[i];\n                    if (n.nodeType == 1 && n.tagName == 'map') {\n                        node = n;\n                        break;\n                    }\n                }\n                if (!!node) {\n                    var ns = node.childNodes;\n                    node = null;\n                    for (var i = 0; i < ns.length; i++) {\n                        n = ns[i];\n                        if (n.nodeType == 1 && n.tagName == 'node') {\n                            node = n;\n                            break;\n                        }\n                    }\n                }\n                return node;\n            },\n\n            _load_node: function (mind, parent_node, xml_node) {\n                var df = jm.format.freemind;\n                var node_id = xml_node.getAttribute('ID');\n                var node_topic = xml_node.getAttribute('TEXT');\n                // look for richcontent\n                if (node_topic == null) {\n                    var topic_children = xml_node.childNodes;\n                    var topic_child = null;\n                    for (var i = 0; i < topic_children.length; i++) {\n                        topic_child = topic_children[i];\n                        //logger.debug(topic_child.tagName);\n                        if (topic_child.nodeType == 1 && topic_child.tagName === 'richcontent') {\n                            node_topic = topic_child.textContent;\n                            break;\n                        }\n                    }\n                }\n                var node_data = df._load_attributes(xml_node);\n                var node_expanded = ('expanded' in node_data) ? (node_data.expanded == 'true') : true;\n                delete node_data.expanded;\n\n                var node_position = xml_node.getAttribute('POSITION');\n                var node_direction = null;\n                if (!!node_position) {\n                    node_direction = node_position == 'left' ? jm.direction.left : jm.direction.right;\n                }\n                //logger.debug(node_position +':'+ node_direction);\n                var node = null;\n                if (!!parent_node) {\n                    node = mind.add_node(parent_node, node_id, node_topic, node_data, node_direction, node_expanded);\n                } else {\n                    node = mind.set_root(node_id, node_topic, node_data);\n                }\n                var children = xml_node.childNodes;\n                var child = null;\n                for (var i = 0; i < children.length; i++) {\n                    child = children[i];\n                    if (child.nodeType == 1 && child.tagName == 'node') {\n                        df._load_node(mind, node, child);\n                    }\n                }\n            },\n\n            _load_attributes: function (xml_node) {\n                var children = xml_node.childNodes;\n                var attr = null;\n                var attr_data = {};\n                for (var i = 0; i < children.length; i++) {\n                    attr = children[i];\n                    if (attr.nodeType == 1 && attr.tagName === 'attribute') {\n                        attr_data[attr.getAttribute('NAME')] = attr.getAttribute('VALUE');\n                    }\n                }\n                return attr_data;\n            },\n\n            _buildmap: function (node, xmllines) {\n                var df = jm.format.freemind;\n                var pos = null;\n                if (!!node.parent && node.parent.isroot) {\n                    pos = node.direction === jm.direction.left ? 'left' : 'right';\n                }\n                xmllines.push('<node');\n                xmllines.push('ID=\\\"' + node.id + '\\\"');\n                if (!!pos) {\n                    xmllines.push('POSITION=\\\"' + pos + '\\\"');\n                }\n                xmllines.push('TEXT=\\\"' + node.topic + '\\\">');\n\n                // store expanded status as an attribute\n                xmllines.push('<attribute NAME=\\\"expanded\\\" VALUE=\\\"' + node.expanded + '\\\"/>');\n\n                // for attributes\n                var node_data = node.data;\n                if (node_data != null) {\n                    for (var k in node_data) {\n                        xmllines.push('<attribute NAME=\\\"' + k + '\\\" VALUE=\\\"' + node_data[k] + '\\\"/>');\n                    }\n                }\n\n                // for children\n                var children = node.children;\n                for (var i = 0; i < children.length; i++) {\n                    df._buildmap(children[i], xmllines);\n                }\n\n                xmllines.push('</node>');\n            },\n        },\n    };\n\n    // ============= utility object =============================================\n\n    jm.util = {\n        is_node: function (node) {\n            return !!node && node instanceof jm.node;\n        },\n        ajax: {\n            request: function (url, param, method, callback, fail_callback) {\n                var a = jm.util.ajax;\n                var p = null;\n                var tmp_param = [];\n                for (var k in param) {\n                    tmp_param.push(encodeURIComponent(k) + '=' + encodeURIComponent(param[k]));\n                }\n                if (tmp_param.length > 0) {\n                    p = tmp_param.join('&');\n                }\n                var xhr = new XMLHttpRequest();\n                if (!xhr) { return; }\n                xhr.onreadystatechange = function () {\n                    if (xhr.readyState == 4) {\n                        if (xhr.status == 200 || xhr.status == 0) {\n                            if (typeof callback === 'function') {\n                                var data = jm.util.json.string2json(xhr.responseText);\n                                if (data != null) {\n                                    callback(data);\n                                } else {\n                                    callback(xhr.responseText);\n                                }\n                            }\n                        } else {\n                            if (typeof fail_callback === 'function') {\n                                fail_callback(xhr);\n                            } else {\n                                logger.error('xhr request failed.', xhr);\n                            }\n                        }\n                    }\n                }\n                method = method || 'GET';\n                xhr.open(method, url, true);\n                xhr.setRequestHeader('If-Modified-Since', '0');\n                if (method == 'POST') {\n                    xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded;charset=utf-8');\n                    xhr.send(p);\n                } else {\n                    xhr.send();\n                }\n            },\n            get: function (url, callback) {\n                return jm.util.ajax.request(url, {}, 'GET', callback);\n            },\n            post: function (url, param, callback) {\n                return jm.util.ajax.request(url, param, 'POST', callback);\n            }\n        },\n\n        dom: {\n            //target,eventType,handler\n            add_event: function (t, e, h) {\n                if (!!t.addEventListener) {\n                    t.addEventListener(e, h, false);\n                } else {\n                    t.attachEvent('on' + e, h);\n                }\n            }\n        },\n\n        file: {\n            read: function (file_data, fn_callback) {\n                var reader = new FileReader();\n                reader.onload = function () {\n                    if (typeof fn_callback === 'function') {\n                        fn_callback(this.result, file_data.name);\n                    }\n                };\n                reader.readAsText(file_data);\n            },\n\n            save: function (file_data, type, name) {\n                var blob;\n                if (typeof $w.Blob === 'function') {\n                    blob = new Blob([file_data], { type: type });\n                } else {\n                    var BlobBuilder = $w.BlobBuilder || $w.MozBlobBuilder || $w.WebKitBlobBuilder || $w.MSBlobBuilder;\n                    var bb = new BlobBuilder();\n                    bb.append(file_data);\n                    blob = bb.getBlob(type);\n                }\n                if (navigator.msSaveBlob) {\n                    navigator.msSaveBlob(blob, name);\n                } else {\n                    var URL = $w.URL || $w.webkitURL;\n                    var bloburl = URL.createObjectURL(blob);\n                    var anchor = $c('a');\n                    if ('download' in anchor) {\n                        anchor.style.visibility = 'hidden';\n                        anchor.href = bloburl;\n                        anchor.download = name;\n                        $d.body.appendChild(anchor);\n                        var evt = $d.createEvent('MouseEvents');\n                        evt.initEvent('click', true, true);\n                        anchor.dispatchEvent(evt);\n                        $d.body.removeChild(anchor);\n                    } else {\n                        location.href = bloburl;\n                    }\n                }\n            }\n        },\n\n        json: {\n            json2string: function (json) {\n                return JSON.stringify(json);\n            },\n            string2json: function (json_str) {\n                return JSON.parse(json_str);\n            },\n            merge: function (b, a) {\n                for (var o in a) {\n                    if (o in b) {\n                        if (typeof b[o] === 'object' &&\n                            Object.prototype.toString.call(b[o]).toLowerCase() == '[object object]' &&\n                            !b[o].length) {\n                            jm.util.json.merge(b[o], a[o]);\n                        } else {\n                            b[o] = a[o];\n                        }\n                    } else {\n                        b[o] = a[o];\n                    }\n                }\n                return b;\n            }\n        },\n\n        uuid: {\n            newid: function () {\n                return (new Date().getTime().toString(16) + Math.random().toString(16).substring(2)).substring(2, 18);\n            }\n        },\n\n        text: {\n            is_empty: function (s) {\n                if (!s) { return true; }\n                return s.replace(/\\s*/, '').length == 0;\n            }\n        }\n    };\n\n    jm.prototype = {\n        init: function () {\n            if (this.initialized) { return; }\n            this.initialized = true;\n\n            var opts = this.options;\n\n            var opts_layout = {\n                mode: opts.mode,\n                hspace: opts.layout.hspace,\n                vspace: opts.layout.vspace,\n                pspace: opts.layout.pspace\n            }\n            var opts_view = {\n                container: opts.container,\n                support_html: opts.support_html,\n                engine: opts.view.engine,\n                hmargin: opts.view.hmargin,\n                vmargin: opts.view.vmargin,\n                line_width: opts.view.line_width,\n                line_color: opts.view.line_color,\n                draggable: opts.view.draggable,\n                hide_scrollbars_when_draggable: opts.view.hide_scrollbars_when_draggable,\n                node_overflow: opts.view.node_overflow\n            };\n            // create instance of function provider\n            this.data = new jm.data_provider(this);\n            this.layout = new jm.layout_provider(this, opts_layout);\n            this.view = new jm.view_provider(this, opts_view);\n            this.shortcut = new jm.shortcut_provider(this, opts.shortcut);\n\n            this.data.init();\n            this.layout.init();\n            this.view.init();\n            this.shortcut.init();\n\n            this._event_bind();\n\n            jm.init_plugins(this);\n        },\n\n        enable_edit: function () {\n            this.options.editable = true;\n        },\n\n        disable_edit: function () {\n            this.options.editable = false;\n        },\n\n        // call enable_event_handle('dblclick')\n        // options are 'mousedown', 'click', 'dblclick'\n        enable_event_handle: function (event_handle) {\n            this.options.default_event_handle['enable_' + event_handle + '_handle'] = true;\n        },\n\n        // call disable_event_handle('dblclick')\n        // options are 'mousedown', 'click', 'dblclick'\n        disable_event_handle: function (event_handle) {\n            this.options.default_event_handle['enable_' + event_handle + '_handle'] = false;\n        },\n\n        get_editable: function () {\n            return this.options.editable;\n        },\n\n        set_theme: function (theme) {\n            var theme_old = this.options.theme;\n            this.options.theme = (!!theme) ? theme : null;\n            if (theme_old != this.options.theme) {\n                this.view.reset_theme();\n                this.view.reset_custom_style();\n            }\n        },\n        _event_bind: function () {\n            this.view.add_event(this, 'mousedown', this.mousedown_handle);\n            this.view.add_event(this, 'click', this.click_handle);\n            this.view.add_event(this, 'dblclick', this.dblclick_handle);\n            this.view.add_event(this, \"mousewheel\", this.mousewheel_handle)\n        },\n\n        mousedown_handle: function (e) {\n            if (!this.options.default_event_handle['enable_mousedown_handle']) {\n                return;\n            }\n            var element = e.target || event.srcElement;\n            var nodeid = this.view.get_binded_nodeid(element);\n            if (!!nodeid) {\n                if (element.tagName.toLowerCase() == 'jmnode') {\n                    this.select_node(nodeid);\n                }\n            } else {\n                this.select_clear();\n            }\n        },\n\n        click_handle: function (e) {\n            if (!this.options.default_event_handle['enable_click_handle']) {\n                return;\n            }\n            var element = e.target || event.srcElement;\n            var isexpander = this.view.is_expander(element);\n            if (isexpander) {\n                var nodeid = this.view.get_binded_nodeid(element);\n                if (!!nodeid) {\n                    this.toggle_node(nodeid);\n                }\n            }\n        },\n\n        dblclick_handle: function (e) {\n            if (!this.options.default_event_handle['enable_dblclick_handle']) {\n                return;\n            }\n            if (this.get_editable()) {\n                var element = e.target || event.srcElement;\n                var nodeid = this.view.get_binded_nodeid(element);\n                if (!!nodeid) {\n                    this.begin_edit(nodeid);\n                }\n            }\n        },\n\n        // Use [Ctrl] + Mousewheel, to zoom in/out.\n        mousewheel_handle: function (event) {\n            // Test if mousewheel option is enabled and Ctrl key is pressed.\n            if (!this.options.default_event_handle[\"enable_mousewheel_handle\"] || !window.event.ctrlKey) {\n                return\n            }\n            // Avoid default page scrolling behavior.\n            event.preventDefault()\n\n            if (event.deltaY < 0) {\n                this.view.zoomIn()\n            } else {\n                this.view.zoomOut()\n            }\n        },\n\n        begin_edit: function (node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return false;\n                } else {\n                    return this.begin_edit(the_node);\n                }\n            }\n            if (this.get_editable()) {\n                this.view.edit_node_begin(node);\n            } else {\n                logger.error('fail, this mind map is not editable.');\n                return;\n            }\n        },\n\n        end_edit: function () {\n            this.view.edit_node_end();\n        },\n\n        toggle_node: function (node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return;\n                } else {\n                    return this.toggle_node(the_node);\n                }\n            }\n            if (node.isroot) { return; }\n            this.view.save_location(node);\n            this.layout.toggle_node(node);\n            this.view.relayout();\n            this.view.restore_location(node);\n        },\n\n        expand_node: function (node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return;\n                } else {\n                    return this.expand_node(the_node);\n                }\n            }\n            if (node.isroot) { return; }\n            this.view.save_location(node);\n            this.layout.expand_node(node);\n            this.view.relayout();\n            this.view.restore_location(node);\n        },\n\n        collapse_node: function (node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return;\n                } else {\n                    return this.collapse_node(the_node);\n                }\n            }\n            if (node.isroot) { return; }\n            this.view.save_location(node);\n            this.layout.collapse_node(node);\n            this.view.relayout();\n            this.view.restore_location(node);\n        },\n\n        expand_all: function () {\n            this.layout.expand_all();\n            this.view.relayout();\n        },\n\n        collapse_all: function () {\n            this.layout.collapse_all();\n            this.view.relayout();\n        },\n\n        expand_to_depth: function (depth) {\n            this.layout.expand_to_depth(depth);\n            this.view.relayout();\n        },\n\n        _reset: function () {\n            this.view.reset();\n            this.layout.reset();\n            this.data.reset();\n        },\n\n        _show: function (mind) {\n            var m = mind || jm.format.node_array.example;\n\n            this.mind = this.data.load(m);\n            if (!this.mind) {\n                logger.error('data.load error');\n                return;\n            } else {\n                logger.debug('data.load ok');\n            }\n\n            this.view.load();\n            logger.debug('view.load ok');\n\n            this.layout.layout();\n            logger.debug('layout.layout ok');\n\n            this.view.show(true);\n            logger.debug('view.show ok');\n\n            this.invoke_event_handle(jm.event_type.show, { data: [mind] });\n        },\n\n        show: function (mind) {\n            this._reset();\n            this._show(mind);\n        },\n\n        get_meta: function () {\n            return {\n                name: this.mind.name,\n                author: this.mind.author,\n                version: this.mind.version\n            };\n        },\n\n        get_data: function (data_format) {\n            var df = data_format || 'node_tree';\n            return this.data.get_data(df);\n        },\n\n        get_root: function () {\n            return this.mind.root;\n        },\n\n        get_node: function (node) {\n            if (jm.util.is_node(node)) {\n                return node;\n            }\n            return this.mind.get_node(node);\n        },\n\n        add_node: function (parent_node, nodeid, topic, data, direction) {\n            if (this.get_editable()) {\n                var the_parent_node = this.get_node(parent_node);\n                var dir = jm.direction.of(direction)\n                if (dir === undefined) {\n                    dir = this.layout.calculate_next_child_direction(the_parent_node);\n                }\n                var node = this.mind.add_node(the_parent_node, nodeid, topic, data, dir);\n                if (!!node) {\n                    this.view.add_node(node);\n                    this.layout.layout();\n                    this.view.show(false);\n                    this.view.reset_node_custom_style(node);\n                    this.expand_node(the_parent_node);\n                    this.invoke_event_handle(jm.event_type.edit, { evt: 'add_node', data: [the_parent_node.id, nodeid, topic, data, dir], node: nodeid });\n                }\n                return node;\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return null;\n            }\n        },\n\n        insert_node_before: function (node_before, nodeid, topic, data, direction) {\n            if (this.get_editable()) {\n                var the_node_before = this.get_node(node_before);\n                var dir = jm.direction.of(direction)\n                if (dir === undefined) {\n                    dir = this.layout.calculate_next_child_direction(the_node_before.parent);\n                }\n                var node = this.mind.insert_node_before(the_node_before, nodeid, topic, data, dir);\n                if (!!node) {\n                    this.view.add_node(node);\n                    this.layout.layout();\n                    this.view.show(false);\n                    this.invoke_event_handle(jm.event_type.edit, { evt: 'insert_node_before', data: [the_node_before.id, nodeid, topic, data, dir], node: nodeid });\n                }\n                return node;\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return null;\n            }\n        },\n\n        insert_node_after: function (node_after, nodeid, topic, data, direction) {\n            if (this.get_editable()) {\n                var the_node_after = this.get_node(node_after);\n                var dir = jm.direction.of(direction)\n                if (dir === undefined) {\n                    dir = this.layout.calculate_next_child_direction(the_node_after.parent);\n                }\n                var node = this.mind.insert_node_after(the_node_after, nodeid, topic, data, dir);\n                if (!!node) {\n                    this.view.add_node(node);\n                    this.layout.layout();\n                    this.view.show(false);\n                    this.invoke_event_handle(jm.event_type.edit, { evt: 'insert_node_after', data: [the_node_after.id, nodeid, topic, data, dir], node: nodeid });\n                }\n                return node;\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return null;\n            }\n        },\n\n        remove_node: function (node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return false;\n                } else {\n                    return this.remove_node(the_node);\n                }\n            }\n            if (this.get_editable()) {\n                if (node.isroot) {\n                    logger.error('fail, can not remove root node');\n                    return false;\n                }\n                var nodeid = node.id;\n                var parentid = node.parent.id;\n                var parent_node = this.get_node(parentid);\n                this.view.save_location(parent_node);\n                this.view.remove_node(node);\n                this.mind.remove_node(node);\n                this.layout.layout();\n                this.view.show(false);\n                this.view.restore_location(parent_node);\n                this.invoke_event_handle(jm.event_type.edit, { evt: 'remove_node', data: [nodeid], node: parentid });\n                return true;\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return false;\n            }\n        },\n\n        update_node: function (nodeid, topic) {\n            if (this.get_editable()) {\n                if (jm.util.text.is_empty(topic)) {\n                    logger.warn('fail, topic can not be empty');\n                    return;\n                }\n                var node = this.get_node(nodeid);\n                if (!!node) {\n                    if (node.topic === topic) {\n                        logger.info('nothing changed');\n                        this.view.update_node(node);\n                        return;\n                    }\n                    node.topic = topic;\n                    this.view.update_node(node);\n                    this.layout.layout();\n                    this.view.show(false);\n                    this.invoke_event_handle(jm.event_type.edit, { evt: 'update_node', data: [nodeid, topic], node: nodeid });\n                }\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return;\n            }\n        },\n\n        move_node: function (nodeid, beforeid, parentid, direction) {\n            if (this.get_editable()) {\n                var node = this.get_node(nodeid);\n                var updated_node = this.mind.move_node(node, beforeid, parentid, direction);\n                if (!!updated_node) {\n                    this.view.update_node(updated_node);\n                    this.layout.layout();\n                    this.view.show(false);\n                    this.invoke_event_handle(jm.event_type.edit, { evt: 'move_node', data: [nodeid, beforeid, parentid, direction], node: nodeid });\n                }\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return;\n            }\n        },\n\n        select_node: function (node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return;\n                } else {\n                    return this.select_node(the_node);\n                }\n            }\n            if (!this.layout.is_visible(node)) {\n                return;\n            }\n            this.mind.selected = node;\n            this.view.select_node(node);\n            this.invoke_event_handle(jm.event_type.select, { evt: 'select_node', data: [], node: node.id });\n        },\n\n        get_selected_node: function () {\n            if (!!this.mind) {\n                return this.mind.selected;\n            } else {\n                return null;\n            }\n        },\n\n        select_clear: function () {\n            if (!!this.mind) {\n                this.mind.selected = null;\n                this.view.select_clear();\n            }\n        },\n\n        is_node_visible: function (node) {\n            return this.layout.is_visible(node);\n        },\n\n        find_node_before: function (node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return;\n                } else {\n                    return this.find_node_before(the_node);\n                }\n            }\n            if (node.isroot) { return null; }\n            var n = null;\n            if (node.parent.isroot) {\n                var c = node.parent.children;\n                var prev = null;\n                var ni = null;\n                for (var i = 0; i < c.length; i++) {\n                    ni = c[i];\n                    if (node.direction === ni.direction) {\n                        if (node.id === ni.id) {\n                            n = prev;\n                        }\n                        prev = ni;\n                    }\n                }\n            } else {\n                n = this.mind.get_node_before(node);\n            }\n            return n;\n        },\n\n        find_node_after: function (node) {\n            if (!jm.util.is_node(node)) {\n                var the_node = this.get_node(node);\n                if (!the_node) {\n                    logger.error('the node[id=' + node + '] can not be found.');\n                    return;\n                } else {\n                    return this.find_node_after(the_node);\n                }\n            }\n            if (node.isroot) { return null; }\n            var n = null;\n            if (node.parent.isroot) {\n                var c = node.parent.children;\n                var getthis = false;\n                var ni = null;\n                for (var i = 0; i < c.length; i++) {\n                    ni = c[i];\n                    if (node.direction === ni.direction) {\n                        if (getthis) {\n                            n = ni;\n                            break;\n                        }\n                        if (node.id === ni.id) {\n                            getthis = true;\n                        }\n                    }\n                }\n            } else {\n                n = this.mind.get_node_after(node);\n            }\n            return n;\n        },\n\n        set_node_color: function (nodeid, bgcolor, fgcolor) {\n            if (this.get_editable()) {\n                var node = this.mind.get_node(nodeid);\n                if (!!node) {\n                    if (!!bgcolor) {\n                        node.data['background-color'] = bgcolor;\n                    }\n                    if (!!fgcolor) {\n                        node.data['foreground-color'] = fgcolor;\n                    }\n                    this.view.reset_node_custom_style(node);\n                }\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return null;\n            }\n        },\n\n        set_node_font_style: function (nodeid, size, weight, style) {\n            if (this.get_editable()) {\n                var node = this.mind.get_node(nodeid);\n                if (!!node) {\n                    if (!!size) {\n                        node.data['font-size'] = size;\n                    }\n                    if (!!weight) {\n                        node.data['font-weight'] = weight;\n                    }\n                    if (!!style) {\n                        node.data['font-style'] = style;\n                    }\n                    this.view.reset_node_custom_style(node);\n                    this.view.update_node(node);\n                    this.layout.layout();\n                    this.view.show(false);\n                }\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return null;\n            }\n        },\n\n        set_node_background_image: function (nodeid, image, width, height, rotation) {\n            if (this.get_editable()) {\n                var node = this.mind.get_node(nodeid);\n                if (!!node) {\n                    if (!!image) {\n                        node.data['background-image'] = image;\n                    }\n                    if (!!width) {\n                        node.data['width'] = width;\n                    }\n                    if (!!height) {\n                        node.data['height'] = height;\n                    }\n                    if (!!rotation) {\n                        node.data['background-rotation'] = rotation;\n                    }\n                    this.view.reset_node_custom_style(node);\n                    this.view.update_node(node);\n                    this.layout.layout();\n                    this.view.show(false);\n                }\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return null;\n            }\n        },\n\n        set_node_background_rotation: function (nodeid, rotation) {\n            if (this.get_editable()) {\n                var node = this.mind.get_node(nodeid);\n                if (!!node) {\n                    if (!node.data['background-image']) {\n                        logger.error('fail, only can change rotation angle of node with background image');\n                        return null;\n                    }\n                    node.data['background-rotation'] = rotation;\n                    this.view.reset_node_custom_style(node);\n                    this.view.update_node(node);\n                    this.layout.layout();\n                    this.view.show(false);\n                }\n            } else {\n                logger.error('fail, this mind map is not editable');\n                return null;\n            }\n        },\n\n        resize: function () {\n            this.view.resize();\n        },\n\n        // callback(type ,data)\n        add_event_listener: function (callback) {\n            if (typeof callback === 'function') {\n                this.event_handles.push(callback);\n            }\n        },\n\n        clear_event_listener: function () {\n            this.event_handles = [];\n        },\n\n        invoke_event_handle: function (type, data) {\n            var j = this;\n            $w.setTimeout(function () {\n                j._invoke_event_handle(type, data);\n            }, 0);\n        },\n\n        _invoke_event_handle: function (type, data) {\n            var l = this.event_handles.length;\n            for (var i = 0; i < l; i++) {\n                this.event_handles[i](type, data);\n            }\n        },\n\n    };\n\n    // ============= data provider =============================================\n\n    jm.data_provider = function (jm) {\n        this.jm = jm;\n    };\n\n    jm.data_provider.prototype = {\n        init: function () {\n            logger.debug('data.init');\n        },\n\n        reset: function () {\n            logger.debug('data.reset');\n        },\n\n        load: function (mind_data) {\n            var df = null;\n            var mind = null;\n            if (typeof mind_data === 'object') {\n                if (!!mind_data.format) {\n                    df = mind_data.format;\n                } else {\n                    df = 'node_tree';\n                }\n            } else {\n                df = 'freemind';\n            }\n\n            if (df == 'node_array') {\n                mind = jm.format.node_array.get_mind(mind_data);\n            } else if (df == 'node_tree') {\n                mind = jm.format.node_tree.get_mind(mind_data);\n            } else if (df == 'freemind') {\n                mind = jm.format.freemind.get_mind(mind_data);\n            } else {\n                logger.warn('unsupported format');\n            }\n            return mind;\n        },\n\n        get_data: function (data_format) {\n            var data = null;\n            if (data_format == 'node_array') {\n                data = jm.format.node_array.get_data(this.jm.mind);\n            } else if (data_format == 'node_tree') {\n                data = jm.format.node_tree.get_data(this.jm.mind);\n            } else if (data_format == 'freemind') {\n                data = jm.format.freemind.get_data(this.jm.mind);\n            } else {\n                logger.error('unsupported ' + data_format + ' format');\n            }\n            return data;\n        },\n    };\n\n    // ============= layout provider ===========================================\n\n    jm.layout_provider = function (jm, options) {\n        this.opts = options;\n        this.jm = jm;\n        this.isside = (this.opts.mode == 'side');\n        this.bounds = null;\n\n        this.cache_valid = false;\n    };\n\n    jm.layout_provider.prototype = {\n        init: function () {\n            logger.debug('layout.init');\n        },\n\n        reset: function () {\n            logger.debug('layout.reset');\n            this.bounds = { n: 0, s: 0, w: 0, e: 0 };\n        },\n\n        calculate_next_child_direction: function (node) {\n            if (this.isside) {\n                return jm.direction.right;\n            }\n            var children = node.children || [];\n            var children_len = children.length;\n            var r = 0;\n            for (var i = 0; i < children_len; i++) { if (children[i].direction === jm.direction.left) { r--; } else { r++; } }\n            return (children_len > 1 && r > 0) ? jm.direction.left : jm.direction.right;\n        },\n\n        layout: function () {\n            logger.debug('layout.layout');\n            this.layout_direction();\n            this.layout_offset();\n        },\n\n        layout_direction: function () {\n            this._layout_direction_root();\n        },\n\n        _layout_direction_root: function () {\n            var node = this.jm.mind.root;\n            // logger.debug(node);\n            var layout_data = null;\n            if ('layout' in node._data) {\n                layout_data = node._data.layout;\n            } else {\n                layout_data = {};\n                node._data.layout = layout_data;\n            }\n            var children = node.children;\n            var children_count = children.length;\n            layout_data.direction = jm.direction.center;\n            layout_data.side_index = 0;\n            if (this.isside) {\n                var i = children_count;\n                while (i--) {\n                    this._layout_direction_side(children[i], jm.direction.right, i);\n                }\n            } else {\n                var i = children_count;\n                var subnode = null;\n                while (i--) {\n                    subnode = children[i];\n                    if (subnode.direction == jm.direction.left) {\n                        this._layout_direction_side(subnode, jm.direction.left, i);\n                    } else {\n                        this._layout_direction_side(subnode, jm.direction.right, i);\n                    }\n                }\n                /*\n                var boundary = Math.ceil(children_count/2);\n                var i = children_count;\n                while(i--){\n                    if(i>=boundary){\n                        this._layout_direction_side(children[i],jm.direction.left, children_count-i-1);\n                    }else{\n                        this._layout_direction_side(children[i],jm.direction.right, i);\n                    }\n                }*/\n\n            }\n        },\n\n        _layout_direction_side: function (node, direction, side_index) {\n            var layout_data = null;\n            if ('layout' in node._data) {\n                layout_data = node._data.layout;\n            } else {\n                layout_data = {};\n                node._data.layout = layout_data;\n            }\n            var children = node.children;\n            var children_count = children.length;\n\n            layout_data.direction = direction;\n            layout_data.side_index = side_index;\n            var i = children_count;\n            while (i--) {\n                this._layout_direction_side(children[i], direction, i);\n            }\n        },\n\n        layout_offset: function () {\n            var node = this.jm.mind.root;\n            var layout_data = node._data.layout;\n            layout_data.offset_x = 0;\n            layout_data.offset_y = 0;\n            layout_data.outer_height = 0;\n            var children = node.children;\n            var i = children.length;\n            var left_nodes = [];\n            var right_nodes = [];\n            var subnode = null;\n            while (i--) {\n                subnode = children[i];\n                if (subnode._data.layout.direction == jm.direction.right) {\n                    right_nodes.unshift(subnode);\n                } else {\n                    left_nodes.unshift(subnode);\n                }\n            }\n            layout_data.left_nodes = left_nodes;\n            layout_data.right_nodes = right_nodes;\n            layout_data.outer_height_left = this._layout_offset_subnodes(left_nodes);\n            layout_data.outer_height_right = this._layout_offset_subnodes(right_nodes);\n            this.bounds.e = node._data.view.width / 2;\n            this.bounds.w = 0 - this.bounds.e;\n            //logger.debug(this.bounds.w);\n            this.bounds.n = 0;\n            this.bounds.s = Math.max(layout_data.outer_height_left, layout_data.outer_height_right);\n        },\n\n        // layout both the x and y axis\n        _layout_offset_subnodes: function (nodes) {\n            var total_height = 0;\n            var nodes_count = nodes.length;\n            var i = nodes_count;\n            var node = null;\n            var node_outer_height = 0;\n            var layout_data = null;\n            var base_y = 0;\n            var pd = null; // parent._data\n            while (i--) {\n                node = nodes[i];\n                layout_data = node._data.layout;\n                if (pd == null) {\n                    pd = node.parent._data;\n                }\n\n                node_outer_height = this._layout_offset_subnodes(node.children);\n                if (!node.expanded) {\n                    node_outer_height = 0;\n                    this.set_visible(node.children, false);\n                }\n                node_outer_height = Math.max(node._data.view.height, node_outer_height);\n\n                layout_data.outer_height = node_outer_height;\n                layout_data.offset_y = base_y - node_outer_height / 2;\n                layout_data.offset_x = this.opts.hspace * layout_data.direction + pd.view.width * (pd.layout.direction + layout_data.direction) / 2;\n                if (!node.parent.isroot) {\n                    layout_data.offset_x += this.opts.pspace * layout_data.direction;\n                }\n\n                base_y = base_y - node_outer_height - this.opts.vspace;\n                total_height += node_outer_height;\n            }\n            if (nodes_count > 1) {\n                total_height += this.opts.vspace * (nodes_count - 1);\n            }\n            i = nodes_count;\n            var middle_height = total_height / 2;\n            while (i--) {\n                node = nodes[i];\n                node._data.layout.offset_y += middle_height;\n            }\n            return total_height;\n        },\n\n        // layout the y axis only, for collapse/expand a node\n        _layout_offset_subnodes_height: function (nodes) {\n            var total_height = 0;\n            var nodes_count = nodes.length;\n            var i = nodes_count;\n            var node = null;\n            var node_outer_height = 0;\n            var layout_data = null;\n            var base_y = 0;\n            var pd = null; // parent._data\n            while (i--) {\n                node = nodes[i];\n                layout_data = node._data.layout;\n                if (pd == null) {\n                    pd = node.parent._data;\n                }\n\n                node_outer_height = this._layout_offset_subnodes_height(node.children);\n                if (!node.expanded) {\n                    node_outer_height = 0;\n                }\n                node_outer_height = Math.max(node._data.view.height, node_outer_height);\n\n                layout_data.outer_height = node_outer_height;\n                layout_data.offset_y = base_y - node_outer_height / 2;\n                base_y = base_y - node_outer_height - this.opts.vspace;\n                total_height += node_outer_height;\n            }\n            if (nodes_count > 1) {\n                total_height += this.opts.vspace * (nodes_count - 1);\n            }\n            i = nodes_count;\n            var middle_height = total_height / 2;\n            while (i--) {\n                node = nodes[i];\n                node._data.layout.offset_y += middle_height;\n                //logger.debug(node.topic);\n                //logger.debug(node._data.layout.offset_y);\n            }\n            return total_height;\n        },\n\n        get_node_offset: function (node) {\n            var layout_data = node._data.layout;\n            var offset_cache = null;\n            if (('_offset_' in layout_data) && this.cache_valid) {\n                offset_cache = layout_data._offset_;\n            } else {\n                offset_cache = { x: -1, y: -1 };\n                layout_data._offset_ = offset_cache;\n            }\n            if (offset_cache.x == -1 || offset_cache.y == -1) {\n                var x = layout_data.offset_x;\n                var y = layout_data.offset_y;\n                if (!node.isroot) {\n                    var offset_p = this.get_node_offset(node.parent);\n                    x += offset_p.x;\n                    y += offset_p.y;\n                }\n                offset_cache.x = x;\n                offset_cache.y = y;\n            }\n            return offset_cache;\n        },\n\n        get_node_point: function (node) {\n            var view_data = node._data.view;\n            var offset_p = this.get_node_offset(node);\n            //logger.debug(offset_p);\n            var p = {};\n            p.x = offset_p.x + view_data.width * (node._data.layout.direction - 1) / 2;\n            p.y = offset_p.y - view_data.height / 2;\n            //logger.debug(p);\n            return p;\n        },\n\n        get_node_point_in: function (node) {\n            var p = this.get_node_offset(node);\n            return p;\n        },\n\n        get_node_point_out: function (node) {\n            var layout_data = node._data.layout;\n            var pout_cache = null;\n            if (('_pout_' in layout_data) && this.cache_valid) {\n                pout_cache = layout_data._pout_;\n            } else {\n                pout_cache = { x: -1, y: -1 };\n                layout_data._pout_ = pout_cache;\n            }\n            if (pout_cache.x == -1 || pout_cache.y == -1) {\n                if (node.isroot) {\n                    pout_cache.x = 0;\n                    pout_cache.y = 0;\n                } else {\n                    var view_data = node._data.view;\n                    var offset_p = this.get_node_offset(node);\n                    pout_cache.x = offset_p.x + (view_data.width + this.opts.pspace) * node._data.layout.direction;\n                    pout_cache.y = offset_p.y;\n                    //logger.debug('pout');\n                    //logger.debug(pout_cache);\n                }\n            }\n            return pout_cache;\n        },\n\n        get_expander_point: function (node) {\n            var p = this.get_node_point_out(node);\n            var ex_p = {};\n            if (node._data.layout.direction == jm.direction.right) {\n                ex_p.x = p.x - this.opts.pspace;\n            } else {\n                ex_p.x = p.x;\n            }\n            ex_p.y = p.y - Math.ceil(this.opts.pspace / 2);\n            return ex_p;\n        },\n\n        get_min_size: function () {\n            var nodes = this.jm.mind.nodes;\n            var node = null;\n            var pout = null;\n            for (var nodeid in nodes) {\n                node = nodes[nodeid];\n                pout = this.get_node_point_out(node);\n                if (pout.x > this.bounds.e) { this.bounds.e = pout.x; }\n                if (pout.x < this.bounds.w) { this.bounds.w = pout.x; }\n            }\n            return {\n                w: this.bounds.e - this.bounds.w,\n                h: this.bounds.s - this.bounds.n\n            }\n        },\n\n        toggle_node: function (node) {\n            if (node.isroot) {\n                return;\n            }\n            if (node.expanded) {\n                this.collapse_node(node);\n            } else {\n                this.expand_node(node);\n            }\n        },\n\n        expand_node: function (node) {\n            node.expanded = true;\n            this.part_layout(node);\n            this.set_visible(node.children, true);\n            this.jm.invoke_event_handle(jm.event_type.show, { evt: 'expand_node', data: [], node: node.id });\n        },\n\n        collapse_node: function (node) {\n            node.expanded = false;\n            this.part_layout(node);\n            this.set_visible(node.children, false);\n            this.jm.invoke_event_handle(jm.event_type.show, { evt: 'collapse_node', data: [], node: node.id });\n        },\n\n        expand_all: function () {\n            var nodes = this.jm.mind.nodes;\n            var c = 0;\n            var node;\n            for (var nodeid in nodes) {\n                node = nodes[nodeid];\n                if (!node.expanded) {\n                    node.expanded = true;\n                    c++;\n                }\n            }\n            if (c > 0) {\n                var root = this.jm.mind.root;\n                this.part_layout(root);\n                this.set_visible(root.children, true);\n            }\n        },\n\n        collapse_all: function () {\n            var nodes = this.jm.mind.nodes;\n            var c = 0;\n            var node;\n            for (var nodeid in nodes) {\n                node = nodes[nodeid];\n                if (node.expanded && !node.isroot) {\n                    node.expanded = false;\n                    c++;\n                }\n            }\n            if (c > 0) {\n                var root = this.jm.mind.root;\n                this.part_layout(root);\n                this.set_visible(root.children, true);\n            }\n        },\n\n        expand_to_depth: function (target_depth, curr_nodes, curr_depth) {\n            if (target_depth < 1) { return; }\n            var nodes = curr_nodes || this.jm.mind.root.children;\n            var depth = curr_depth || 1;\n            var i = nodes.length;\n            var node = null;\n            while (i--) {\n                node = nodes[i];\n                if (depth < target_depth) {\n                    if (!node.expanded) {\n                        this.expand_node(node);\n                    }\n                    this.expand_to_depth(target_depth, node.children, depth + 1);\n                }\n                if (depth == target_depth) {\n                    if (node.expanded) {\n                        this.collapse_node(node);\n                    }\n                }\n            }\n        },\n\n        part_layout: function (node) {\n            var root = this.jm.mind.root;\n            if (!!root) {\n                var root_layout_data = root._data.layout;\n                if (node.isroot) {\n                    root_layout_data.outer_height_right = this._layout_offset_subnodes_height(root_layout_data.right_nodes);\n                    root_layout_data.outer_height_left = this._layout_offset_subnodes_height(root_layout_data.left_nodes);\n                } else {\n                    if (node._data.layout.direction == jm.direction.right) {\n                        root_layout_data.outer_height_right = this._layout_offset_subnodes_height(root_layout_data.right_nodes);\n                    } else {\n                        root_layout_data.outer_height_left = this._layout_offset_subnodes_height(root_layout_data.left_nodes);\n                    }\n                }\n                this.bounds.s = Math.max(root_layout_data.outer_height_left, root_layout_data.outer_height_right);\n                this.cache_valid = false;\n            } else {\n                logger.warn('can not found root node');\n            }\n        },\n\n        set_visible: function (nodes, visible) {\n            var i = nodes.length;\n            var node = null;\n            var layout_data = null;\n            while (i--) {\n                node = nodes[i];\n                layout_data = node._data.layout;\n                if (node.expanded) {\n                    this.set_visible(node.children, visible);\n                } else {\n                    this.set_visible(node.children, false);\n                }\n                if (!node.isroot) {\n                    node._data.layout.visible = visible;\n                }\n            }\n        },\n\n        is_expand: function (node) {\n            return node.expanded;\n        },\n\n        is_visible: function (node) {\n            var layout_data = node._data.layout;\n            if (('visible' in layout_data) && !layout_data.visible) {\n                return false;\n            } else {\n                return true;\n            }\n        }\n    };\n\n    jm.graph_canvas = function (view) {\n        this.opts = view.opts;\n        this.e_canvas = $c('canvas');\n        this.e_canvas.className = 'jsmind';\n        this.canvas_ctx = this.e_canvas.getContext('2d');\n        this.size = { w: 0, h: 0 };\n    };\n\n    jm.graph_canvas.prototype = {\n        element: function () {\n            return this.e_canvas;\n        },\n\n        set_size: function (w, h) {\n            this.size.w = w;\n            this.size.h = h;\n            this.e_canvas.width = w;\n            this.e_canvas.height = h;\n        },\n\n        clear: function () {\n            this.canvas_ctx.clearRect(0, 0, this.size.w, this.size.h);\n        },\n\n        draw_line: function (pout, pin, offset) {\n            var ctx = this.canvas_ctx;\n            ctx.strokeStyle = this.opts.line_color;\n            ctx.lineWidth = this.opts.line_width;\n            ctx.lineCap = 'round';\n\n            this._bezier_to(ctx,\n                pin.x + offset.x,\n                pin.y + offset.y,\n                pout.x + offset.x,\n                pout.y + offset.y);\n        },\n\n        copy_to: function (dest_canvas_ctx, callback) {\n            dest_canvas_ctx.drawImage(this.e_canvas, 0, 0);\n            !!callback && callback();\n        },\n\n        _bezier_to: function (ctx, x1, y1, x2, y2) {\n            ctx.beginPath();\n            ctx.moveTo(x1, y1);\n            ctx.bezierCurveTo(x1 + (x2 - x1) * 2 / 3, y1, x1, y2, x2, y2);\n            ctx.stroke();\n        },\n\n        _line_to: function (ctx, x1, y1, x2, y2) {\n            ctx.beginPath();\n            ctx.moveTo(x1, y1);\n            ctx.lineTo(x2, y2);\n            ctx.stroke();\n        }\n    };\n\n    jm.graph_svg = function (view) {\n        this.view = view;\n        this.opts = view.opts;\n        this.e_svg = jm.graph_svg.c('svg');\n        this.e_svg.setAttribute('class', 'jsmind');\n        this.size = { w: 0, h: 0 };\n        this.lines = [];\n    };\n\n    jm.graph_svg.c = function (tag) {\n        return $d.createElementNS('http://www.w3.org/2000/svg', tag);\n    };\n\n    jm.graph_svg.prototype = {\n        element: function () {\n            return this.e_svg;\n        },\n\n        set_size: function (w, h) {\n            this.size.w = w;\n            this.size.h = h;\n            this.e_svg.setAttribute('width', w);\n            this.e_svg.setAttribute('height', h);\n        },\n\n        clear: function () {\n            var len = this.lines.length;\n            while (len--) {\n                this.e_svg.removeChild(this.lines[len]);\n            }\n            this.lines.length = 0;\n        },\n\n        draw_line: function (pout, pin, offset) {\n            var line = jm.graph_svg.c('path');\n            line.setAttribute('stroke', this.opts.line_color);\n            line.setAttribute('stroke-width', this.opts.line_width);\n            line.setAttribute('fill', 'transparent');\n            this.lines.push(line);\n            this.e_svg.appendChild(line);\n            this._bezier_to(line, pin.x + offset.x, pin.y + offset.y, pout.x + offset.x, pout.y + offset.y);\n        },\n\n        copy_to: function (dest_canvas_ctx, callback) {\n            var img = new Image();\n            img.onload = function () {\n                dest_canvas_ctx.drawImage(img, 0, 0);\n                !!callback && callback();\n            }\n            img.src = 'data:image/svg+xml;base64,' + btoa(new XMLSerializer().serializeToString(this.e_svg));\n        },\n\n        _bezier_to: function (path, x1, y1, x2, y2) {\n            path.setAttribute('d', 'M' + x1 + ' ' + y1 + ' C ' + (x1 + (x2 - x1) * 2 / 3) + ' ' + y1 + ', ' + x1 + ' ' + y2 + ', ' + x2 + ' ' + y2);\n        },\n\n        _line_to: function (path, x1, y1, x2, y2) {\n            path.setAttribute('d', 'M ' + x1 + ' ' + y1 + ' L ' + x2 + ' ' + y2);\n        }\n    };\n\n    // view provider\n    jm.view_provider = function (jm, options) {\n        this.opts = options;\n        this.jm = jm;\n        this.layout = jm.layout;\n\n        this.container = null;\n        this.e_panel = null;\n        this.e_nodes = null;\n\n        this.size = { w: 0, h: 0 };\n\n        this.selected_node = null;\n        this.editing_node = null;\n\n        this.graph = null;\n    };\n\n    jm.view_provider.prototype = {\n        init: function () {\n            logger.debug('view.init');\n\n            this.container = $i(this.opts.container) ? this.opts.container : $g(this.opts.container);\n            if (!this.container) {\n                logger.error('the options.view.container was not be found in dom');\n                return;\n            }\n            this.e_panel = $c('div');\n            this.e_nodes = $c('jmnodes');\n            this.e_editor = $c('input');\n\n            this.graph = this.opts.engine.toLowerCase() === 'svg' ? new jm.graph_svg(this) : new jm.graph_canvas(this);\n            this.e_panel.className = 'jsmind-inner jmnode-overflow-' + this.opts.node_overflow;\n            this.e_panel.tabIndex = 1;\n            this.e_panel.appendChild(this.graph.element());\n            this.e_panel.appendChild(this.e_nodes);\n\n            this.e_editor.className = 'jsmind-editor';\n            this.e_editor.type = 'text';\n\n            this.actualZoom = 1;\n            this.zoomStep = 0.1;\n            this.minZoom = 0.5;\n            this.maxZoom = 2;\n\n            var v = this;\n            jm.util.dom.add_event(this.e_editor, 'keydown', function (e) {\n                var evt = e || event;\n                if (evt.keyCode == 13) { v.edit_node_end(); evt.stopPropagation(); }\n            });\n            jm.util.dom.add_event(this.e_editor, 'blur', function (e) {\n                v.edit_node_end();\n            });\n\n            this.container.appendChild(this.e_panel);\n\n            // Used to avoid dragging, while editing node.\n            this.dragging_enabled = true\n\n            this.draggable_canvas()\n        },\n\n        add_event: function (obj, event_name, event_handle) {\n            jm.util.dom.add_event(this.e_nodes, event_name, function (e) {\n                var evt = e || event;\n                event_handle.call(obj, evt);\n            });\n        },\n\n        get_binded_nodeid: function (element) {\n            if (element == null) {\n                return null;\n            }\n            var tagName = element.tagName.toLowerCase();\n            if (tagName == 'jmnodes' || tagName == 'body' || tagName == 'html') {\n                return null;\n            }\n            if (tagName == 'jmnode' || tagName == 'jmexpander') {\n                return element.getAttribute('nodeid');\n            } else {\n                return this.get_binded_nodeid(element.parentElement);\n            }\n        },\n\n        is_expander: function (element) {\n            return (element.tagName.toLowerCase() == 'jmexpander');\n        },\n\n        reset: function () {\n            logger.debug('view.reset');\n            this.selected_node = null;\n            this.clear_lines();\n            this.clear_nodes();\n            this.reset_theme();\n        },\n\n        reset_theme: function () {\n            var theme_name = this.jm.options.theme;\n            if (!!theme_name) {\n                this.e_nodes.className = 'theme-' + theme_name;\n            } else {\n                this.e_nodes.className = '';\n            }\n        },\n\n        reset_custom_style: function () {\n            var nodes = this.jm.mind.nodes;\n            for (var nodeid in nodes) {\n                this.reset_node_custom_style(nodes[nodeid]);\n            }\n        },\n\n        load: function () {\n            logger.debug('view.load');\n            this.init_nodes();\n        },\n\n        expand_size: function () {\n            var min_size = this.layout.get_min_size();\n            var min_width = min_size.w + this.opts.hmargin * 2;\n            var min_height = min_size.h + this.opts.vmargin * 2;\n            var client_w = this.e_panel.clientWidth;\n            var client_h = this.e_panel.clientHeight;\n            if (client_w < min_width) { client_w = min_width; }\n            if (client_h < min_height) { client_h = min_height; }\n            this.size.w = client_w;\n            this.size.h = client_h;\n        },\n\n        init_nodes_size: function (node) {\n            var view_data = node._data.view;\n            view_data.width = view_data.element.clientWidth;\n            view_data.height = view_data.element.clientHeight;\n        },\n\n        init_nodes: function () {\n            var nodes = this.jm.mind.nodes;\n            var doc_frag = $d.createDocumentFragment();\n            for (var nodeid in nodes) {\n                this.create_node_element(nodes[nodeid], doc_frag);\n            }\n            this.e_nodes.appendChild(doc_frag);\n            for (var nodeid in nodes) {\n                this.init_nodes_size(nodes[nodeid]);\n            }\n        },\n\n        add_node: function (node) {\n            this.create_node_element(node, this.e_nodes);\n            this.init_nodes_size(node);\n        },\n\n        create_node_element: function (node, parent_node) {\n            var view_data = null;\n            if ('view' in node._data) {\n                view_data = node._data.view;\n            } else {\n                view_data = {};\n                node._data.view = view_data;\n            }\n\n            var d = $c('jmnode');\n            if (node.isroot) {\n                d.className = 'root';\n            } else {\n                var d_e = $c('jmexpander');\n                $t(d_e, '-');\n                d_e.setAttribute('nodeid', node.id);\n                d_e.style.visibility = 'hidden';\n                parent_node.appendChild(d_e);\n                view_data.expander = d_e;\n            }\n            if (!!node.topic) {\n                if (this.opts.support_html) {\n                    $h(d, node.topic);\n                } else {\n                    $t(d, node.topic);\n                }\n            }\n            d.setAttribute('nodeid', node.id);\n            d.style.visibility = 'hidden';\n            this._reset_node_custom_style(d, node.data);\n\n            parent_node.appendChild(d);\n            view_data.element = d;\n        },\n\n        remove_node: function (node) {\n            if (this.selected_node != null && this.selected_node.id == node.id) {\n                this.selected_node = null;\n            }\n            if (this.editing_node != null && this.editing_node.id == node.id) {\n                node._data.view.element.removeChild(this.e_editor);\n                this.editing_node = null;\n            }\n            var children = node.children;\n            var i = children.length;\n            while (i--) {\n                this.remove_node(children[i]);\n            }\n            if (node._data.view) {\n                var element = node._data.view.element;\n                var expander = node._data.view.expander;\n                this.e_nodes.removeChild(element);\n                this.e_nodes.removeChild(expander);\n                node._data.view.element = null;\n                node._data.view.expander = null;\n            }\n        },\n\n        update_node: function (node) {\n            var view_data = node._data.view;\n            var element = view_data.element;\n            if (!!node.topic) {\n                if (this.opts.support_html) {\n                    $h(element, node.topic);\n                } else {\n                    $t(element, node.topic);\n                }\n            }\n            if (this.layout.is_visible(node)) {\n                view_data.width = element.clientWidth;\n                view_data.height = element.clientHeight;\n            } else {\n                let origin_style = element.getAttribute('style');\n                element.style = 'visibility: visible; left:0; top:0;';\n                view_data.width = element.clientWidth;\n                view_data.height = element.clientHeight;\n                element.style = origin_style;\n            }\n        },\n\n        select_node: function (node) {\n            if (!!this.selected_node) {\n                this.selected_node._data.view.element.className =\n                    this.selected_node._data.view.element.className.replace(/\\s*selected\\b/i, '');\n                this.reset_node_custom_style(this.selected_node);\n            }\n            if (!!node) {\n                this.selected_node = node;\n                node._data.view.element.className += ' selected';\n                this.clear_node_custom_style(node);\n            }\n        },\n\n        select_clear: function () {\n            this.select_node(null);\n        },\n\n        get_editing_node: function () {\n            return this.editing_node;\n        },\n\n        is_editing: function () {\n            return (!!this.editing_node);\n        },\n\n        edit_node_begin: function (node) {\n            if (!node.topic) {\n                logger.warn(\"don't edit image nodes\");\n                return;\n            }\n            if (this.editing_node != null) {\n                this.edit_node_end();\n            }\n            this.editing_node = node;\n            var view_data = node._data.view;\n            var element = view_data.element;\n            var topic = node.topic;\n            var ncs = getComputedStyle(element);\n            this.e_editor.value = topic;\n            this.e_editor.style.width = (element.clientWidth - parseInt(ncs.getPropertyValue('padding-left')) - parseInt(ncs.getPropertyValue('padding-right'))) + 'px';\n            element.innerHTML = '';\n            element.appendChild(this.e_editor);\n            element.style.zIndex = 5;\n            this.e_editor.focus();\n            this.e_editor.select();\n        },\n\n        edit_node_end: function () {\n            if (this.editing_node != null) {\n                var node = this.editing_node;\n                this.editing_node = null;\n                var view_data = node._data.view;\n                var element = view_data.element;\n                var topic = this.e_editor.value;\n                element.style.zIndex = 'auto';\n                element.removeChild(this.e_editor);\n                if (jm.util.text.is_empty(topic) || node.topic === topic) {\n                    if (this.opts.support_html) {\n                        $h(element, node.topic);\n                    } else {\n                        $t(element, node.topic);\n                    }\n                } else {\n                    this.jm.update_node(node.id, topic);\n                }\n            }\n            this.e_panel.focus();\n        },\n\n        get_view_offset: function () {\n            var bounds = this.layout.bounds;\n            var _x = (this.size.w - bounds.e - bounds.w) / 2;\n            var _y = this.size.h / 2;\n            return { x: _x, y: _y };\n        },\n\n        resize: function () {\n            this.graph.set_size(1, 1);\n            this.e_nodes.style.width = '1px';\n            this.e_nodes.style.height = '1px';\n\n            this.expand_size();\n            this._show();\n        },\n\n        _show: function () {\n            this.graph.set_size(this.size.w, this.size.h);\n            this.e_nodes.style.width = this.size.w + 'px';\n            this.e_nodes.style.height = this.size.h + 'px';\n            this.show_nodes();\n            this.show_lines();\n            //this.layout.cache_valid = true;\n            this.jm.invoke_event_handle(jm.event_type.resize, { data: [] });\n        },\n\n        zoomIn: function () {\n            return this.setZoom(this.actualZoom + this.zoomStep);\n        },\n\n        zoomOut: function () {\n            return this.setZoom(this.actualZoom - this.zoomStep);\n        },\n\n        setZoom: function (zoom) {\n            if ((zoom < this.minZoom) || (zoom > this.maxZoom)) {\n                return false;\n            }\n            this.actualZoom = zoom;\n            for (var i = 0; i < this.e_panel.children.length; i++) {\n                this.e_panel.children[i].style.zoom = zoom;\n            };\n            this.show(true);\n            return true;\n\n        },\n\n        _center_root: function () {\n            // center root node\n            var outer_w = this.e_panel.clientWidth;\n            var outer_h = this.e_panel.clientHeight;\n            if (this.size.w > outer_w) {\n                var _offset = this.get_view_offset();\n                this.e_panel.scrollLeft = _offset.x * this.actualZoom - outer_w / 2;\n            }\n            if (this.size.h > outer_h) {\n                this.e_panel.scrollTop = (this.size.h * this.actualZoom - outer_h) / 2;\n            }\n        },\n\n        show: function (keep_center) {\n            logger.debug('view.show');\n            this.expand_size();\n            this._show();\n            if (!!keep_center) {\n                this._center_root();\n            }\n        },\n\n        relayout: function () {\n            this.expand_size();\n            this._show();\n        },\n\n        save_location: function (node) {\n            var vd = node._data.view;\n            vd._saved_location = {\n                x: parseInt(vd.element.style.left) - this.e_panel.scrollLeft,\n                y: parseInt(vd.element.style.top) - this.e_panel.scrollTop,\n            };\n        },\n\n        restore_location: function (node) {\n            var vd = node._data.view;\n            this.e_panel.scrollLeft = parseInt(vd.element.style.left) - vd._saved_location.x;\n            this.e_panel.scrollTop = parseInt(vd.element.style.top) - vd._saved_location.y;\n        },\n\n        clear_nodes: function () {\n            var mind = this.jm.mind;\n            if (mind == null) {\n                return;\n            }\n            var nodes = mind.nodes;\n            var node = null;\n            for (var nodeid in nodes) {\n                node = nodes[nodeid];\n                node._data.view.element = null;\n                node._data.view.expander = null;\n            }\n            this.e_nodes.innerHTML = '';\n        },\n\n        show_nodes: function () {\n            var nodes = this.jm.mind.nodes;\n            var node = null;\n            var node_element = null;\n            var expander = null;\n            var p = null;\n            var p_expander = null;\n            var expander_text = '-';\n            var view_data = null;\n            var _offset = this.get_view_offset();\n            for (var nodeid in nodes) {\n                node = nodes[nodeid];\n                view_data = node._data.view;\n                node_element = view_data.element;\n                expander = view_data.expander;\n                if (!this.layout.is_visible(node)) {\n                    node_element.style.display = 'none';\n                    expander.style.display = 'none';\n                    continue;\n                }\n                this.reset_node_custom_style(node);\n                p = this.layout.get_node_point(node);\n                view_data.abs_x = _offset.x + p.x;\n                view_data.abs_y = _offset.y + p.y;\n                node_element.style.left = (_offset.x + p.x) + 'px';\n                node_element.style.top = (_offset.y + p.y) + 'px';\n                node_element.style.display = '';\n                node_element.style.visibility = 'visible';\n                if (!node.isroot && node.children.length > 0) {\n                    expander_text = node.expanded ? '-' : '+';\n                    p_expander = this.layout.get_expander_point(node);\n                    expander.style.left = (_offset.x + p_expander.x) + 'px';\n                    expander.style.top = (_offset.y + p_expander.y) + 'px';\n                    expander.style.display = '';\n                    expander.style.visibility = 'visible';\n                    $t(expander, expander_text);\n                }\n                // hide expander while all children have been removed\n                if (!node.isroot && node.children.length == 0) {\n                    expander.style.display = 'none';\n                    expander.style.visibility = 'hidden';\n                }\n            }\n        },\n\n        reset_node_custom_style: function (node) {\n            this._reset_node_custom_style(node._data.view.element, node.data);\n        },\n\n        _reset_node_custom_style: function (node_element, node_data) {\n            if ('background-color' in node_data) {\n                node_element.style.backgroundColor = node_data['background-color'];\n            }\n            if ('foreground-color' in node_data) {\n                node_element.style.color = node_data['foreground-color'];\n            }\n            if ('width' in node_data) {\n                node_element.style.width = node_data['width'] + 'px';\n            }\n            if ('height' in node_data) {\n                node_element.style.height = node_data['height'] + 'px';\n            }\n            if ('font-size' in node_data) {\n                node_element.style.fontSize = node_data['font-size'] + 'px';\n            }\n            if ('font-weight' in node_data) {\n                node_element.style.fontWeight = node_data['font-weight'];\n            }\n            if ('font-style' in node_data) {\n                node_element.style.fontStyle = node_data['font-style'];\n            }\n            if ('background-image' in node_data) {\n                var backgroundImage = node_data['background-image'];\n                if (backgroundImage.startsWith('data') && node_data['width'] && node_data['height']) {\n                    var img = new Image();\n\n                    img.onload = function () {\n                        var c = $c('canvas');\n                        c.width = node_element.clientWidth;\n                        c.height = node_element.clientHeight;\n                        var img = this;\n                        if (c.getContext) {\n                            var ctx = c.getContext('2d');\n                            ctx.drawImage(img, 2, 2, node_element.clientWidth, node_element.clientHeight);\n                            var scaledImageData = c.toDataURL();\n                            node_element.style.backgroundImage = 'url(' + scaledImageData + ')';\n                        }\n                    };\n                    img.src = backgroundImage;\n\n                } else {\n                    node_element.style.backgroundImage = 'url(' + backgroundImage + ')';\n                }\n                node_element.style.backgroundSize = '99%';\n\n                if ('background-rotation' in node_data) {\n                    node_element.style.transform = 'rotate(' + node_data['background-rotation'] + 'deg)';\n                }\n            }\n        },\n\n        clear_node_custom_style: function (node) {\n            var node_element = node._data.view.element;\n            node_element.style.backgroundColor = \"\";\n            node_element.style.color = \"\";\n        },\n\n        clear_lines: function () {\n            this.graph.clear();\n        },\n\n        show_lines: function () {\n            this.clear_lines();\n            var nodes = this.jm.mind.nodes;\n            var node = null;\n            var pin = null;\n            var pout = null;\n            var _offset = this.get_view_offset();\n            for (var nodeid in nodes) {\n                node = nodes[nodeid];\n                if (!!node.isroot) { continue; }\n                if (('visible' in node._data.layout) && !node._data.layout.visible) { continue; }\n                pin = this.layout.get_node_point_in(node);\n                pout = this.layout.get_node_point_out(node.parent);\n                this.graph.draw_line(pout, pin, _offset);\n            }\n        },\n\n        // Drag the whole mind map with your mouse (usefull when it's larger that the container).\n        draggable_canvas: function () {\n            // If draggable option is true.\n            if (this.opts.draggable) {\n                // Dragging disabled by default.\n                let dragging = false\n                let x, y\n                if (this.opts.hide_scrollbars_when_draggable) {\n                    // Avoid scrollbars when mind map is larger than the container (e_panel = id jsmind-inner)\n                    this.e_panel.style = 'overflow: hidden'\n                }\n                // Move the whole mind map with mouse moves, while button is down.\n                jm.util.dom.add_event(this.container, 'mousedown', (eventDown) => {\n                    dragging = true\n                    // Record current mouse position.\n                    x = eventDown.clientX\n                    y = eventDown.clientY\n                })\n                // Stop moving mind map once mouse button is released.\n                jm.util.dom.add_event(this.container, 'mouseup', () => {\n                    dragging = false\n                })\n                // Follow current mouse position and move mind map accordingly.\n                jm.util.dom.add_event(this.container, 'mousemove', (eventMove) => {\n                    if (this.dragging_enabled && dragging) {\n                        this.e_panel.scrollBy(x - eventMove.clientX, y - eventMove.clientY)\n                        // Record new current position.\n                        x = eventMove.clientX\n                        y = eventMove.clientY\n                    }\n                })\n            }\n        },\n\n        get_draggable_canvas: function () {\n            return this.opts.draggable\n        },\n\n        enable_draggable_canvas: function () {\n            this.dragging_enabled = true\n        },\n\n        disable_draggable_canvas: function () {\n            this.dragging_enabled = false\n        },\n\n    };\n\n    // shortcut provider\n    jm.shortcut_provider = function (jm, options) {\n        this.jm = jm;\n        this.opts = options;\n        this.mapping = options.mapping;\n        this.handles = options.handles;\n        this._newid = null;\n        this._mapping = {};\n    };\n\n    jm.shortcut_provider.prototype = {\n        init: function () {\n            jm.util.dom.add_event(this.jm.view.e_panel, 'keydown', this.handler.bind(this));\n\n            this.handles['addchild'] = this.handle_addchild;\n            this.handles['addbrother'] = this.handle_addbrother;\n            this.handles['editnode'] = this.handle_editnode;\n            this.handles['delnode'] = this.handle_delnode;\n            this.handles['toggle'] = this.handle_toggle;\n            this.handles['up'] = this.handle_up;\n            this.handles['down'] = this.handle_down;\n            this.handles['left'] = this.handle_left;\n            this.handles['right'] = this.handle_right;\n\n            for (var handle in this.mapping) {\n                if (!!this.mapping[handle] && (handle in this.handles)) {\n                    var keys = this.mapping[handle];\n                    if(!Array.isArray(keys)){\n                        keys = [keys]\n                    }\n                    for(let key of keys){\n                        this._mapping[key] = this.handles[handle];\n                    }\n                }\n            }\n\n            if (typeof this.opts.id_generator === 'function') {\n                this._newid = this.opts.id_generator;\n            } else {\n                this._newid = jm.util.uuid.newid;\n            }\n        },\n\n        enable_shortcut: function () {\n            this.opts.enable = true;\n        },\n\n        disable_shortcut: function () {\n            this.opts.enable = false;\n        },\n\n        handler: function (e) {\n            if (e.which == 9) { e.preventDefault(); } //prevent tab to change focus in browser\n            if (this.jm.view.is_editing()) { return; }\n            var evt = e || event;\n            if (!this.opts.enable) { return true; }\n            var kc = evt.keyCode + (evt.metaKey << 13) + (evt.ctrlKey << 12) + (evt.altKey << 11) + (evt.shiftKey << 10);\n            if (kc in this._mapping) {\n                this._mapping[kc].call(this, this.jm, e);\n            }\n        },\n\n        handle_addchild: function (_jm, e) {\n            var selected_node = _jm.get_selected_node();\n            if (!!selected_node) {\n                var nodeid = this._newid();\n                var node = _jm.add_node(selected_node, nodeid, 'New Node');\n                if (!!node) {\n                    _jm.select_node(nodeid);\n                    _jm.begin_edit(nodeid);\n                }\n            }\n        },\n        handle_addbrother: function (_jm, e) {\n            var selected_node = _jm.get_selected_node();\n            if (!!selected_node && !selected_node.isroot) {\n                var nodeid = this._newid();\n                var node = _jm.insert_node_after(selected_node, nodeid, 'New Node');\n                if (!!node) {\n                    _jm.select_node(nodeid);\n                    _jm.begin_edit(nodeid);\n                }\n            }\n        },\n        handle_editnode: function (_jm, e) {\n            var selected_node = _jm.get_selected_node();\n            if (!!selected_node) {\n                _jm.begin_edit(selected_node);\n            }\n        },\n        handle_delnode: function (_jm, e) {\n            var selected_node = _jm.get_selected_node();\n            if (!!selected_node && !selected_node.isroot) {\n                _jm.select_node(selected_node.parent);\n                _jm.remove_node(selected_node);\n            }\n        },\n        handle_toggle: function (_jm, e) {\n            var evt = e || event;\n            var selected_node = _jm.get_selected_node();\n            if (!!selected_node) {\n                _jm.toggle_node(selected_node.id);\n                evt.stopPropagation();\n                evt.preventDefault();\n            }\n        },\n        handle_up: function (_jm, e) {\n            var evt = e || event;\n            var selected_node = _jm.get_selected_node();\n            if (!!selected_node) {\n                var up_node = _jm.find_node_before(selected_node);\n                if (!up_node) {\n                    var np = _jm.find_node_before(selected_node.parent);\n                    if (!!np && np.children.length > 0) {\n                        up_node = np.children[np.children.length - 1];\n                    }\n                }\n                if (!!up_node) {\n                    _jm.select_node(up_node);\n                }\n                evt.stopPropagation();\n                evt.preventDefault();\n            }\n        },\n\n        handle_down: function (_jm, e) {\n            var evt = e || event;\n            var selected_node = _jm.get_selected_node();\n            if (!!selected_node) {\n                var down_node = _jm.find_node_after(selected_node);\n                if (!down_node) {\n                    var np = _jm.find_node_after(selected_node.parent);\n                    if (!!np && np.children.length > 0) {\n                        down_node = np.children[0];\n                    }\n                }\n                if (!!down_node) {\n                    _jm.select_node(down_node);\n                }\n                evt.stopPropagation();\n                evt.preventDefault();\n            }\n        },\n\n        handle_left: function (_jm, e) {\n            this._handle_direction(_jm, e, jm.direction.left);\n        },\n        handle_right: function (_jm, e) {\n            this._handle_direction(_jm, e, jm.direction.right);\n        },\n        _handle_direction: function (_jm, e, d) {\n            var evt = e || event;\n            var selected_node = _jm.get_selected_node();\n            var node = null;\n            if (!!selected_node) {\n                if (selected_node.isroot) {\n                    var c = selected_node.children;\n                    var children = [];\n                    for (var i = 0; i < c.length; i++) {\n                        if (c[i].direction === d) {\n                            children.push(i);\n                        }\n                    }\n                    node = c[children[Math.floor((children.length - 1) / 2)]];\n                }\n                else if (selected_node.direction === d) {\n                    var children = selected_node.children;\n                    var childrencount = children.length;\n                    if (childrencount > 0) {\n                        node = children[Math.floor((childrencount - 1) / 2)];\n                    }\n                } else {\n                    node = selected_node.parent;\n                }\n                if (!!node) {\n                    _jm.select_node(node);\n                }\n                evt.stopPropagation();\n                evt.preventDefault();\n            }\n        },\n    };\n\n\n    // plugin\n    jm.plugin = function (name, init) {\n        this.name = name;\n        this.init = init;\n    };\n\n    jm.plugins = [];\n\n    jm.register_plugin = function (plugin) {\n        if (plugin instanceof jm.plugin) {\n            jm.plugins.push(plugin);\n        }\n    };\n\n    jm.init_plugins = function (sender) {\n        $w.setTimeout(function () {\n            jm._init_plugins(sender);\n        }, 0);\n    };\n\n    jm._init_plugins = function (sender) {\n        var l = jm.plugins.length;\n        var fn_init = null;\n        for (var i = 0; i < l; i++) {\n            fn_init = jm.plugins[i].init;\n            if (typeof fn_init === 'function') {\n                fn_init(sender);\n            }\n        }\n    };\n\n    // quick way\n    jm.show = function (options, mind) {\n        var _jm = new jm(options);\n        _jm.show(mind);\n        return _jm;\n    };\n\n    // export jsmind\n    if (typeof module !== 'undefined' && typeof exports === 'object') {\n        module.exports = jm;\n    } else if (typeof define === 'function' && (define.amd || define.cmd)) {\n        define(function () { return jm; });\n    } else {\n        $w[__name__] = jm;\n    }\n})(typeof window !== 'undefined' ? window : global);\n","import { defineComponent as _defineComponent } from 'vue'\nimport { unref as _unref, createVNode as _createVNode, createElementVNode as _createElementVNode, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\"\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-46ab36ed\"),n=n(),_popScopeId(),n)\nconst _hoisted_1 = /*#__PURE__*/ _withScopeId(() => /*#__PURE__*/_createElementVNode(\"div\", {\n  id: \"container\",\n  class: \"container\"\n}, null, -1))\n\nimport { onMounted, defineAsyncComponent } from 'vue';\nimport { open_view } from './utils';\n\nexport default /*#__PURE__*/_defineComponent({\n  __name: 'Home',\n  setup(__props) {\n\nconst LeftComponent = defineAsyncComponent(() => import('./Code.vue'));\nconst RightComponent = defineAsyncComponent(() => import('./Options.vue'));\n\nonMounted(() => {\n  open_view();\n});\n\nreturn (_ctx: any,_cache: any) => {\n  return (_openBlock(), _createElementBlock(_Fragment, null, [\n    _createVNode(_unref(LeftComponent)),\n    _hoisted_1,\n    _createVNode(_unref(RightComponent))\n  ], 64))\n}\n}\n\n})","import script from \"./Home.vue?vue&type=script&lang=ts&setup=true\"\nexport * from \"./Home.vue?vue&type=script&lang=ts&setup=true\"\n\nimport \"./Home.vue?vue&type=style&index=0&id=46ab36ed&lang=less&scoped=true\"\n\nimport exportComponent from \"F:\\\\sla-mind\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-46ab36ed\"]])\n\nexport default __exports__"],"names":["THEME","ThemeOption","label","value","PRIMARY","WARNING","DANGER","SUCCESS","INFO","GREENSEA","NEPHRITE","BELIZEHOLE","WISTERIA","ASPHALT","ORANGE","PUMPKIN","POMEGRANATE","CLOUDS","ASBESTOS","MODE","LOGLEVEL","Object","defineProperty","window","jsMind","configurable","writable","meta","reactive","name","author","version","format","ref","data","id","topic","children","direction","width","height","options","container","editable","theme","mode","support_html","log_level","view","engine","hmargin","vmargin","line_width","line_color","draggable","hide_scrollbars_when_draggable","node_overflow","layout","hspace","vspace","pspace","shortcut","enable","handles","mapping","addchild","addbrother","editnode","delnode","toggle","left","up","right","down","_jm","open_view","mind","show","set_theme","theme_name","handle_editable","bool","disable_edit","ElMessage","enable_edit","$w","__name__","__version__","__author__","_noop","logger","console","log","debug","error","warn","info","module","exports","$d","document","$g","getElementById","$c","tag","createElement","$t","n","t","hasChildNodes","firstChild","nodeValue","appendChild","createTextNode","$h","HTMLElement","innerHTML","$i","el","nodeType","style","ownerDocument","String","prototype","startsWith","p","this","slice","length","DEFAULT_OPTIONS","default_event_handle","enable_mousedown_handle","enable_click_handle","enable_dblclick_handle","enable_mousewheel_handle","jm","current","opts","util","json","merge","initialized","event_handles","init","center","of","dir","parseInt","toLowerCase","event_type","resize","edit","select","key","ctrl","alt","shift","node","sId","iIndex","sTopic","oData","bIsRoot","oParent","eDirection","bExpanded","index","isroot","parent","expanded","_data","compare","node1","node2","r","i1","i2","inherited","pnode","pid","is_node","get_location","vd","x","abs_x","y","abs_y","get_size","w","h","root","selected","nodes","get_node","nodeid","set_root","_put_node","add_node","parent_node","idx","node_index","push","_reindex","insert_node_before","node_before","get_node_before","the_node","insert_node_after","node_after","get_node_after","brothers","move_node","before_id","parent_id","_move_node","_flow_node_direction","len","_move_node_internal","beforeid","parentid","sibling","si","splice","remove_node","ci","k","sort","i","node_tree","example","get_mind","source","df","_parse","get_data","_buildnode","node_root","_extract_data","_extract_subnode","node_json","node_parent","d","o","node_data","node_array","_array","narray","reverse","root_node","_extract_root","root_json","extract_count","node_direction","sub_extract_count","_array_node","freemind","xml","xml_doc","_parse_xml","xml_root","_find_root","_load_node","xmllines","_buildmap","join","DOMParser","parser","parseFromString","ActiveXObject","async","loadXML","childNodes","tagName","ns","xml_node","node_id","getAttribute","node_topic","topic_children","topic_child","textContent","_load_attributes","node_expanded","node_position","child","attr","attr_data","pos","ajax","request","url","param","method","callback","fail_callback","tmp_param","encodeURIComponent","xhr","XMLHttpRequest","onreadystatechange","readyState","status","string2json","responseText","open","setRequestHeader","send","get","post","dom","add_event","e","addEventListener","attachEvent","file","read","file_data","fn_callback","reader","FileReader","onload","result","readAsText","save","type","blob","Blob","BlobBuilder","MozBlobBuilder","WebKitBlobBuilder","MSBlobBuilder","bb","append","getBlob","navigator","msSaveBlob","URL","webkitURL","bloburl","createObjectURL","anchor","visibility","href","download","body","evt","createEvent","initEvent","dispatchEvent","removeChild","location","json2string","JSON","stringify","json_str","parse","b","a","toString","call","uuid","newid","Date","getTime","Math","random","substring","text","is_empty","s","replace","opts_layout","opts_view","data_provider","layout_provider","view_provider","shortcut_provider","_event_bind","init_plugins","enable_event_handle","event_handle","disable_event_handle","get_editable","theme_old","reset_theme","reset_custom_style","mousedown_handle","click_handle","dblclick_handle","mousewheel_handle","element","target","event","srcElement","get_binded_nodeid","select_node","select_clear","isexpander","is_expander","toggle_node","begin_edit","ctrlKey","preventDefault","deltaY","zoomIn","zoomOut","edit_node_begin","end_edit","edit_node_end","save_location","relayout","restore_location","expand_node","collapse_node","expand_all","collapse_all","expand_to_depth","depth","_reset","reset","_show","m","load","invoke_event_handle","get_meta","data_format","get_root","the_parent_node","undefined","calculate_next_child_direction","reset_node_custom_style","the_node_before","the_node_after","update_node","updated_node","is_visible","get_selected_node","is_node_visible","find_node_before","c","prev","ni","find_node_after","getthis","set_node_color","bgcolor","fgcolor","set_node_font_style","size","weight","set_node_background_image","image","rotation","set_node_background_rotation","add_event_listener","clear_event_listener","j","setTimeout","_invoke_event_handle","l","mind_data","isside","bounds","cache_valid","children_len","layout_direction","layout_offset","_layout_direction_root","layout_data","children_count","side_index","_layout_direction_side","subnode","offset_x","offset_y","outer_height","left_nodes","right_nodes","unshift","outer_height_left","_layout_offset_subnodes","outer_height_right","max","total_height","nodes_count","node_outer_height","base_y","pd","set_visible","middle_height","_layout_offset_subnodes_height","get_node_offset","offset_cache","_offset_","offset_p","get_node_point","view_data","get_node_point_in","get_node_point_out","pout_cache","_pout_","get_expander_point","ex_p","ceil","get_min_size","pout","part_layout","target_depth","curr_nodes","curr_depth","root_layout_data","visible","is_expand","graph_canvas","e_canvas","className","canvas_ctx","getContext","set_size","clear","clearRect","draw_line","pin","offset","ctx","strokeStyle","lineWidth","lineCap","_bezier_to","copy_to","dest_canvas_ctx","drawImage","x1","y1","x2","y2","beginPath","moveTo","bezierCurveTo","stroke","_line_to","lineTo","graph_svg","e_svg","setAttribute","lines","createElementNS","line","img","Image","src","btoa","XMLSerializer","serializeToString","path","e_panel","e_nodes","selected_node","editing_node","graph","e_editor","tabIndex","actualZoom","zoomStep","minZoom","maxZoom","v","keyCode","stopPropagation","dragging_enabled","draggable_canvas","obj","event_name","parentElement","clear_lines","clear_nodes","init_nodes","expand_size","min_size","min_width","min_height","client_w","clientWidth","client_h","clientHeight","init_nodes_size","doc_frag","createDocumentFragment","create_node_element","d_e","expander","_reset_node_custom_style","origin_style","clear_node_custom_style","get_editing_node","is_editing","ncs","getComputedStyle","getPropertyValue","zIndex","focus","get_view_offset","_x","_y","show_nodes","show_lines","setZoom","zoom","_center_root","outer_w","outer_h","_offset","scrollLeft","scrollTop","keep_center","_saved_location","top","node_element","p_expander","expander_text","display","backgroundColor","color","fontSize","fontWeight","fontStyle","backgroundImage","scaledImageData","toDataURL","backgroundSize","transform","dragging","eventDown","clientX","clientY","eventMove","scrollBy","get_draggable_canvas","enable_draggable_canvas","disable_draggable_canvas","_newid","_mapping","handle","handler","bind","handle_addchild","handle_addbrother","handle_editnode","handle_delnode","handle_toggle","handle_up","handle_down","handle_left","handle_right","keys","Array","isArray","id_generator","enable_shortcut","disable_shortcut","which","kc","metaKey","altKey","shiftKey","up_node","np","down_node","_handle_direction","floor","childrencount","plugin","plugins","register_plugin","sender","_init_plugins","fn_init","global","_withScopeId","_pushScopeId","_popScopeId","_hoisted_1","_createElementVNode","class","_defineComponent","__name","setup","__props","LeftComponent","defineAsyncComponent","RightComponent","onMounted","_ctx","_cache","_openBlock","_createElementBlock","_Fragment","_createVNode","_unref","__exports__"],"sourceRoot":""}